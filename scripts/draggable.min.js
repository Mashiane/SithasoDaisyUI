gj.draggable={plugins:{}},gj.draggable.config={base:{handle:void 0,vertical:!0,horizontal:!0,containment:void 0}},gj.draggable.methods={init:function(jsConfig){var $handleEl,data,$dragEl=this;return gj.widget.prototype.init.call(this,jsConfig,"draggable"),data=this.data(),$dragEl.attr("data-draggable","true"),($handleEl=gj.draggable.methods.getHandleElement($dragEl)).on("touchstart mousedown",(function(e){var position=gj.core.position($dragEl[0]);$dragEl[0].style.top=position.top+"px",$dragEl[0].style.left=position.left+"px",$dragEl[0].style.position="fixed",$dragEl.attr("draggable-dragging",!0),$dragEl.removeAttr("draggable-x").removeAttr("draggable-y"),gj.documentManager.subscribeForEvent("touchmove",$dragEl.data("guid"),gj.draggable.methods.createMoveHandler($dragEl,$handleEl,data)),gj.documentManager.subscribeForEvent("mousemove",$dragEl.data("guid"),gj.draggable.methods.createMoveHandler($dragEl,$handleEl,data))})),gj.documentManager.subscribeForEvent("mouseup",$dragEl.data("guid"),gj.draggable.methods.createUpHandler($dragEl)),gj.documentManager.subscribeForEvent("touchend",$dragEl.data("guid"),gj.draggable.methods.createUpHandler($dragEl)),gj.documentManager.subscribeForEvent("touchcancel",$dragEl.data("guid"),gj.draggable.methods.createUpHandler($dragEl)),$dragEl},getHandleElement:function($dragEl){var $handle=$dragEl.data("handle");return $handle&&$handle.length?$handle:$dragEl},createUpHandler:function($dragEl){return function(e){"true"===$dragEl.attr("draggable-dragging")&&($dragEl.attr("draggable-dragging",!1),gj.documentManager.unsubscribeForEvent("mousemove",$dragEl.data("guid")),gj.documentManager.unsubscribeForEvent("touchmove",$dragEl.data("guid")),gj.draggable.events.stop($dragEl,{x:$dragEl.mouseX(e),y:$dragEl.mouseY(e)}))}},createMoveHandler:function($dragEl,$handleEl,data){return function(e){var mouseX,mouseY,offsetX,offsetY,prevX,prevY;"true"===$dragEl.attr("draggable-dragging")&&(mouseX=Math.round($dragEl.mouseX(e)),mouseY=Math.round($dragEl.mouseY(e)),prevX=$dragEl.attr("draggable-x"),prevY=$dragEl.attr("draggable-y"),prevX&&prevY?(offsetX=data.horizontal?mouseX-parseInt(prevX,10):0,offsetY=data.vertical?mouseY-parseInt(prevY,10):0,gj.draggable.methods.move($dragEl[0],data,offsetX,offsetY,mouseX,mouseY)):gj.draggable.events.start($dragEl,mouseX,mouseY),$dragEl.attr("draggable-x",mouseX),$dragEl.attr("draggable-y",mouseY))}},move:function(dragEl,data,offsetX,offsetY,mouseX,mouseY){var contPosition,maxTop,maxLeft,position=gj.core.position(dragEl),newTop=position.top+offsetY,newLeft=position.left+offsetX;data.containment&&(maxTop=(contPosition=gj.core.position(data.containment)).top+gj.core.height(data.containment)-gj.core.height(dragEl),maxLeft=contPosition.left+gj.core.width(data.containment)-gj.core.width(dragEl),newTop>contPosition.top&&newTop<maxTop?(contPosition.top>=mouseY||contPosition.bottom<=mouseY)&&(newTop=position.top):newTop=newTop<=contPosition.top?contPosition.top+1:maxTop-1,newLeft>contPosition.left&&newLeft<maxLeft?(contPosition.left>=mouseX||contPosition.right<=mouseX)&&(newLeft=position.left):newLeft=newLeft<=contPosition.left?contPosition.left+1:maxLeft-1),!1!==gj.draggable.events.drag($(dragEl),newLeft,newTop,mouseX,mouseY)&&(dragEl.style.top=newTop+"px",dragEl.style.left=newLeft+"px")},destroy:function($dragEl){return"true"===$dragEl.attr("data-draggable")&&(gj.documentManager.unsubscribeForEvent("mouseup",$dragEl.data("guid")),$dragEl.removeData(),$dragEl.removeAttr("data-guid").removeAttr("data-type").removeAttr("data-draggable"),$dragEl.removeAttr("draggable-x").removeAttr("draggable-y").removeAttr("draggable-dragging"),$dragEl[0].style.top="",$dragEl[0].style.left="",$dragEl[0].style.position="",$dragEl.off("drag").off("start").off("stop"),gj.draggable.methods.getHandleElement($dragEl).off("mousedown")),$dragEl}},gj.draggable.events={drag:function($dragEl,newLeft,newTop,mouseX,mouseY){return $dragEl.triggerHandler("drag",[{left:newLeft,top:newTop},{x:mouseX,y:mouseY}])},start:function($dragEl,mouseX,mouseY){$dragEl.triggerHandler("start",[{x:mouseX,y:mouseY}])},stop:function($dragEl,mousePosition){$dragEl.triggerHandler("stop",[mousePosition])}},gj.draggable.widget=function($element,jsConfig){var self=this,methods=gj.draggable.methods;return $element.destroy||(this.destroy=function(){return methods.destroy(this)}),$.extend($element,this),"true"!==$element.attr("data-draggable")&&methods.init.call($element,jsConfig),$element},gj.draggable.widget.prototype=new gj.widget,gj.draggable.widget.constructor=gj.draggable.widget,function($){$.fn.draggable=function(method){var $widget;if(this&&this.length){if("object"!=typeof method&&method){if(($widget=new gj.draggable.widget(this,null))[method])return $widget[method].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+method+" does not exist."}return new gj.draggable.widget(this,method)}}}(jQuery);