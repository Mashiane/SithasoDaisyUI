
/* sithasodaisyalasqle */
function banano_sithasodaisyalasqle_modala() {var _B;this.instr=function(_stext,_sfind) {if (_B==null) _B=this;return _stext.toLowerCase().indexOf(_sfind.toLowerCase());};this.cdbl=function(_o) {if (_B==null) _B=this;var _out,_nvalue,_nout;_o=_B.val(_o,_B);_out=BANano_nf(BANano_r(_o, 2),0);_nvalue=_B.cstr(_out,_B);_nvalue=_nvalue.split(",").join(".");_nvalue=_B.val(_nvalue,_B);_nout=parseFloat(_nvalue);return _nout;};this.cstr=function(_o) {if (_B==null) _B=this;if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};this.cbool=function(_v) {if (_B==null) _B=this;var _s;if (is.null(_v) || is.undefined(_v)) {_v=false;}if (typeof _v=="string" || typeof _v=="object") {_s=_v+"";_s=_s.toLowerCase();if (_s=="") { return false;}if (_s=="false") { return false;}if (_s=="true") { return true;}if (_s=="1") { return true;}if (_s=="y") { return true;}if (_s=="0") { return false;}if (_s=="n") { return false;}if (_s=="no") { return false;}if (_s=="yes") { return true;}}return _v;};this.cint=function(_o) {if (_B==null) _B=this;_o=_B.val(_o,_B);return parseInt(_o);};this.isnan=function(_obj) {if (_B==null) _B=this;var _res;_res=window["isNaN"](_obj);return _res;};this.val=function(_value) {if (_B==null) _B=this;var _sout,_mout,_slen,_i;_value=_B.cstr(_value,_B);_value=_value.trim();if (_value=="") {_value="0";}if (_B.isnan(_value,_B)) {_value="0";}try {_sout="";_mout="";_slen=_value.length;_i=0;for (_i=0;_i<=_slen-1;_i++) {_mout=_value.charAt(_i);if (_B.instr("0123456789.-",_mout,_B)!=-1) {_sout=_sout+_mout;}}return _sout;} catch(err) {return _value;}};}function banano_sithasodaisyalasqle_sduialasqle() {var _B=this;_B._db_bool="BOOL";_B._db_int="INT";_B._db_string="STRING";_B._db_real="REAL";_B._db_blob="BLOB";_B._db_float="FLOAT";_B._db_integer="INTEGER";_B._db_text="TEXT";_B._db_double="DOUBLE";_B._schema={};_B._tablename="";_B._primarykey="";_B._response="";_B._result=[];_B._command="";_B._types=[];_B._args=[];_B._query="";_B._json="";_B._error="";_B._affectedrows=0;_B._record={};_B._ok=false;_B._auto="";_B._dbase="";_B._view="";_B._action="";_B._bcount=false;_B._usebrackets=false;_B._wherefield={};_B._ops=[];_B._orderbyl=[];_B._flds=[];_B._rowcount=0;_B._lastposition=0;_B._resultjson="";_B._recordjson="";_B._displayfield="";_B._singular="";_B._plural="";_B._displayvalue="";_B.reset=function() {_B._record={};_B._result.length=0;_B._command="";_B._ops.length=0;_B._types.length=0;_B._args.length=0;_B._query="";_B._response="";_B._error="";_B._affectedrows=0;_B._json="";_B._ok=false;_B._lastposition=-1;_B._rowcount=0;};_B.setschemafromdatamodel=function(_models) {var _tm,_fldsx,_fm,_fldtype,_fldname;if ((_B._tablename in _models)==false) {throw "SetSchemaFromDataModel." + _B._tablename + " data-model does NOT exist!";return;}_tm=_models[_B._tablename];_B._primarykey=_tm["pk"]===undefined? "":_tm["pk"];_B._schema={};_fldsx=_tm["fields"];for (var _fmindex=0;_fmindex<_fldsx.length;_fmindex++) {_fm=_fldsx[_fmindex];_fldtype=_fm["type"];_fldname=_fm["name"];switch ("" + _fldtype) {case "" + "TEXT":case "" + "STRING":_B.schemaaddtext1(_fldname,_B);break;case "" + "BLOB":_B.schemaaddblob1(_fldname,_B);break;case "" + "INT":case "" + "INTEGER":_B.schemaaddint1(_fldname,_B);break;case "" + "DOUBLE":case "" + "REAL":case "" + "FLOAT":_B.schemaadddouble1(_fldname,_B);break;case "" + "BOOL":_B.schemaaddboolean1(_fldname,_B);break;}}};_B.gettablenames=function() {var _BANp = gBANp(arguments);_B._query="SHOW TABLES FROM " + _B._dbase + "";_B._command="select";};_B.clear_where=function() {var _BANp = gBANp(arguments);_B._wherefield={};_B._ops.length=0;_B._orderbyl.length=0;_B._flds.length=0;};_B.add_field=function(_fld) {_B._flds.push(_fld);return _B;};_B.add_fields=function(_fields) {var _fld;for (var _fldindex=0;_fldindex<_fields.length;_fldindex++) {_fld=_fields[_fldindex];_B.add_field(_fld,_B);}return _B;};_B.add_where=function(_fld,_operator,_value) {_B._wherefield[_fld]=_value;_B._ops.push(_operator);return _B;};_B.add_order_by=function(_fld) {_B._orderbyl.push(_fld);return _B;};_B.getdatabases=function() {var _BANp = gBANp(arguments);_B._query="SHOW DATABASES";_B._command="select";};_B.createindex=function(_idxfld) {_B._query="CREATE INDEX " + _B._tablename + "" + _idxfld + " ON " + _B._tablename + "(" + _idxfld + ")";_B._command="execute";};_B.showcreatetable=function() {var _BANp = gBANp(arguments);_B._query="SHOW CREATE TABLE " + _B._tablename + "";_B._command="select";_B._bcount=true;};_B.getcount=function() {var _BANp = gBANp(arguments);_B._query="select count(*) as records from " + _B._tablename + "";_B._command="select";_B._bcount=true;return _B;};_B.getsum=function() {var _BANp = gBANp(arguments);_B._query="select sum(" + _B._primarykey + ") as " + _B._primarykey + " from " + _B._tablename + "";_B._command="select";return _B;};_B.initialize=function(_dbname,_tblname,_pk,_ai) {var _BANp = gBANp(arguments);_B._dbase=_dbname;_B._schema={};_B._tablename=_tblname;_B._primarykey=_pk;_B._auto=_ai;_B._response="";_B._result.length=0;_B._command="";_B._types.length=0;_B._args.length=0;_B._query="";_B._json="";_B._error="";_B._affectedrows=0;_B._record={};_B._ok=false;_B._view="";_B._action="";_B._bcount=false;_B._usebrackets=true;_B._orderbyl.length=0;_B._wherefield={};_B._flds.length=0;_B._ops.length=0;_B._rowcount=0;_B._lastposition=-1;_B.clear_where(_BANp,_B);return _B;};_B.setcallback=function(_v,_a) {_B._view=_v;_B._action=_a;};_B.schemaaddblob=function(_bools) {var _BANp = gBANp(arguments);var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_blob;}return _B;};_B.schemaaddblob1=function(_b) {_B._schema[_b]=_B._db_blob;return _B;};_B.schemaaddboolean=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_bool;}return _B;};_B.schemaaddboolean1=function(_b) {_B._schema[_b]=_B._db_bool;return _B;};_B.schemaadddouble1=function(_b) {_B._schema[_b]=_B._db_double;return _B;};_B.schemaadddouble=function(_bools) {var _BANp = gBANp(arguments);var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_double;}return _B;};_B.schemaaddfloat1=function(_b) {_B._schema[_b]=_B._db_float;return _B;};_B.schemaaddfloat=function(_bools) {var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_float;}return _B;};_B.schemaaddtext1=function(_b) {_B._schema[_b]=_B._db_string;return _B;};_B.schemaaddtext=function(_bools) {var _BANp = gBANp(arguments);var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_string;}return _B;};_B.schemaaddint1=function(_b) {_B._schema[_b]=_B._db_int;return _B;};_B.schemaaddint=function(_bools) {var _BANp = gBANp(arguments);var _b;for (var _bindex=0;_bindex<_bools.length;_bindex++) {_b=_bools[_bindex];_B._schema[_b]=_B._db_int;}return _B;};_B.schemaaddfield=function(_fldname,_fldtype) {_B._schema[_fldname]=_fldtype;};_B.setfield=function(_fldname,_fldvalue) {_B._record[_fldname]=_fldvalue;return _B;};_B.recordfrommap=function(_sm) {var _k,_v;_B._record={};var _kKeys = Object.keys(_sm);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_sm[_k];_B._record[_k]=_v;}};_B.firstrecord=function() {var _rec;_rec=_B._result[0];return _rec;};_B.build=function() {var _largs,_ltypes,_b;_largs=[];_ltypes=[];_largs=((_B._args.length==0) ? null : _B._args);_ltypes=((_B._types.length==0) ? null : _B._types);_b={};_b["command"]=_B._command;_b["query"]=_B._query;_b["args"]=_largs;_b["types"]=_ltypes;return _b;};_B.fromjson=function() {var _srecord;_B._lastposition=-1;_B._resultjson="";_B._recordjson="";try {_B._response="Success";_B._error="";_B._affectedrows=_B._result.length;_B._ok=true;if (_B._bcount) {if (_B._result.length>=0) {_B._record=_B._result[0];_B._recordjson=JSON.stringify(_B._record);_srecord=_B._record["records"]===undefined? 0:_B._record["records"];_B._affectedrows=parseInt(_srecord);} else {_B._affectedrows=0;}}_B._rowcount=_B._affectedrows;_B._resultjson=JSON.stringify(_B._result);return _B;} catch(err) {_B._rowcount=0;return _B;}};_B.nextrow=function() {var _realsize;_B._lastposition=_B._lastposition+1;_realsize=_B._rowcount-1;if (_B._lastposition>_realsize) {return false;} else {_B.setposition(_B._lastposition,_B);return true;}};_B.update=function(_privalue) {var _tblwhere;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Update: '" + _B._tablename + "' schema is not set!");}_tblwhere={};_tblwhere[_B._primarykey]=_privalue;_B.updatewhere(_B._record,_tblwhere,null,_B);return _B;};_B.updateby=function(_pk,_pv) {_B._primarykey=_pk;_B.update(_pv,_B);};_B.update1=function(_rec,_privalue) {var _BANp = gBANp(arguments);var _tblwhere;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Update1: '" + _B._tablename + "' schema is not set!");}_B._record=_rec;_B._recordjson=JSON.stringify(_B._record);_tblwhere={};_tblwhere[_B._primarykey]=_privalue;_B.updatewhere(_rec,_tblwhere,null,_BANp,_B);return _B;};_B.updatewait=async function(_rec,_privalue) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.update1(_rec,_privalue,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);return true;};_B.schemaclear=function() {var _BANp = gBANp(arguments);_B._schema={};return _B;};_B.getnextid=function() {var _nextid,_strid,_nr,_ni;_nextid=0;_strid="";if (_B._result.length==0) {_nextid=0;} else {_nr=_B._result[0];_ni=_nr[_B._primarykey]===undefined? "0":_nr[_B._primarykey];_nextid=parseInt(_ni);}_nextid=_nextid+1;_strid=_B.cstr(_nextid,_B);_nextid=parseInt(_nextid);return _strid;};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.getmapvalues=function(_sourcemap) {var _BANp = gBANp(arguments);var _listofvalues,_icnt,_itot,_key,_value,_vtype;_listofvalues=[];_listofvalues.length=0;_icnt=0;_itot=0;_itot=Object.keys(_sourcemap).length-1;for (_icnt=0;_icnt<=_itot;_icnt++) {_key=banano_getB4JKeyAt(_sourcemap,_icnt);_value=banano_getB4JValueAt(_sourcemap,_icnt);_value=_B.cstr(_value,_B);_value=_value.trim();_vtype=_B.getmaptype(_key,_B);switch ("" + _vtype) {case "" + "i":if (_value=="") {_value="0";}_value=parseInt(_value);break;case "" + "d":if (_value=="") {_value="0";}_value=parseFloat(_value);break;case "" + "s":case "" + "b":break;}_listofvalues.push(_value);}return _listofvalues;};_B.joinfields=function(_delimiter,_lst) {var _BANp = gBANp(arguments);var _i,_sb,_fld;_i=0;_sb=new StringBuilder();_fld="";_sb.init();_sb.isinitialized=true;_fld=_lst[0];_fld=_B.escapefield(_fld,_B);_sb.append(_fld);for (_i=1;_i<=_lst.length-1;_i++) {_fld=_lst[_i];_fld=_B.escapefield(_fld,_B);_sb.append(_delimiter).append(_fld);}return _sb.toString();};_B.getmapkeys=function(_sourcemap) {var _listofvalues,_icnt,_itot,_value;_listofvalues=[];_listofvalues.length=0;_icnt=0;_itot=0;_itot=Object.keys(_sourcemap).length-1;for (_icnt=0;_icnt<=_itot;_icnt++) {_value=banano_getB4JKeyAt(_sourcemap,_icnt);_listofvalues.push(_value);}return _listofvalues;};_B.json2map=function(_strjson) {var _jsonx,_map1;_jsonx={};_map1={};_map1={};_map1={};try {if (_strjson.length>0) {_jsonx=JSON.parse(_strjson);_map1=_jsonx;}return _map1;} catch(err) {return _map1;}};_B.delete=function(_primaryvalue) {var _BANp = gBANp(arguments);var _qw;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Delete: '" + _B._tablename + "' schema is not set!");}_qw={};_qw[_B._primarykey]=_primaryvalue;_B.deletewhere(_qw,["="],_BANp,_B);return _B;};_B.deleteby=function(_pk,_pv) {_B._primarykey=_pk;_B.delete(_pv,_B);};_B.escapefield=function(_f) {var _BANp = gBANp(arguments);if (_B._usebrackets) {return "[" + _f + "]";} else {return _f;}};_B.schemacreatetable=function() {var _BANp = gBANp(arguments);_B.createtable(_B._schema,_BANp,_B);return _B;};_B.schemacreatetablewait=async function() {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.schemacreatetable(_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);return true;};_B.createtable=function(_tblfields) {var _BANp = gBANp(arguments);var _fldname,_fldtype,_fldtot,_fldcnt,_sb;_fldname="";_fldtype="";_fldtot=0;_fldcnt=0;_fldtot=Object.keys(_tblfields).length-1;_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("(");for (_fldcnt=0;_fldcnt<=_fldtot;_fldcnt++) {_fldname=banano_getB4JKeyAt(_tblfields,_fldcnt);_fldtype=_tblfields[_fldname];_fldtype=_fldtype.split("STRING").join("TEXT");if (_fldcnt>0) {_sb.append(", ");}_sb.append(_B.escapefield(_fldname,_BANp,_B));_sb.append(" ");_sb.append(_fldtype);if (_fldname.equalsIgnoreCase(_B._auto)) {_sb.append(" AUTOINCREMENT");}if (_fldname.equalsIgnoreCase(_B._primarykey)) {_sb.append(" PRIMARY KEY");}}_sb.append(")");_B._query="CREATE TABLE IF NOT EXISTS "+_B.escapefield(_B._tablename,_BANp,_B)+" "+_sb.toString();_B._command="createtable";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.newlist=function() {var _BANp = gBANp(arguments);var _lst;_lst=[];_lst.length=0;return _lst;};_B.insertbulk=function(_recs) {var _ssql;_ssql="SELECT * INTO [" + _B._tablename + "] FROM ?";_B._query=_ssql;_B._args=[_recs];_B._command="insert";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.insertlist=function() {var _ssql;_ssql="SELECT * INTO [" + _B._tablename + "] FROM ?";_B._query=_ssql;_B._command="insert";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.getmax=function() {var _BANp = gBANp(arguments);var _sb;_sb="SELECT MAX([" + _B._primarykey + "]) As [" + _B._primarykey + "] FROM " + _B.escapefield(_B._tablename,_BANp,_B) + "";_B._query=_sb;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.getmaxby=function(_sname) {_B._primarykey=_sname;_B.getmax(_B);};_B.getmin=function() {var _BANp = gBANp(arguments);var _sb;_sb="SELECT MIN([" + _B._primarykey + "]) As [" + _B._primarykey + "] FROM " + _B.escapefield(_B._tablename,_BANp,_B) + "";_B._query=_sb;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.droptable=function() {var _BANp = gBANp(arguments);_B._query="DROP TABLE "+_B.escapefield(_B._tablename,_BANp,_B);_B._response="";_B._error="";_B._command="droptable";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.execute=function(_strsql) {var _BANp = gBANp(arguments);_strsql=_strsql.trim();_B._query=_strsql;_B._command="execute";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.executewait=async function(_qry) {var _db;_B._query=_qry;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.execute(_B._query,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return true;};_B.insert=function() {if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Insert1: '" + _B._tablename + "' schema is not set!");}_B.insert1(_B._record,_B);return _B;};_B.insert1=function(_rec) {var _BANp = gBANp(arguments);var _sb,_columns,_values,_listofvalues,_listoftypes,_icnt,_itot,_col;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Insert1: '" + _B._tablename + "' schema is not set!");}_sb=new StringBuilder();_columns=new StringBuilder();_values=new StringBuilder();_listofvalues=_B.getmapvalues(_rec,_BANp,_B);_listoftypes=_B.getmaptypes(_rec,_BANp,_B);_icnt=0;_itot=0;_sb.init();_sb.isinitialized=true;_columns.init();_columns.isinitialized=true;_values.init();_values.isinitialized=true;_sb.append("INSERT INTO " + _B.escapefield(_B._tablename,_BANp,_B) + " (");_itot=Object.keys(_rec).length-1;for (_icnt=0;_icnt<=_itot;_icnt++) {_col=banano_getB4JKeyAt(_rec,_icnt);if (_icnt>0) {_columns.append(", ");_values.append(", ");}_columns.append(_B.escapefield(_col,_BANp,_B));_values.append("?");}_sb.append(_columns.toString());_sb.append(") VALUES (");_sb.append(_values.toString());_sb.append(")");_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="insert";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.setrecord=function(_rec) {var _k,_v;var _kKeys = Object.keys(_rec);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_rec[_k];_B.setfield(_k,_v,_B);}};_B.preparerecord=function() {_B._record={};};_B.insertwait=async function() {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.insert1(_B._record,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);return true;};_B.getmaptype=function(_k) {var _coltype;if ((_k in _B._schema)) {_coltype=_B._schema[_k]===undefined? "STRING":_B._schema[_k];switch ("" + _coltype) {case "" + "INTEGER":case "" + "INT":case "" + "BOOL":case "" + "BOOLEAN":return "i";case "" + "BLOB":return "b";case "" + "REAL":case "" + "FLOAT":case "" + "DOUBLE":return "d";default:return "s";}} else {return "s";}};_B.getmaptypes=function(_sourcemap) {var _BANp = gBANp(arguments);var _listoftypes,_icnt,_itot,_col,_coltype;_listoftypes=[];_listoftypes.length=0;_icnt=0;_itot=0;_itot=Object.keys(_sourcemap).length-1;for (_icnt=0;_icnt<=_itot;_icnt++) {_col=banano_getB4JKeyAt(_sourcemap,_icnt);_coltype=_B._schema[_col]===undefined? "STRING":_B._schema[_col];switch ("" + _coltype) {case "" + "INTEGER":case "" + "INT":case "" + "BOOL":case "" + "BOOLEAN":_listoftypes.push("i");break;case "" + "BLOB":_listoftypes.push("b");break;case "" + "REAL":case "" + "FLOAT":case "" + "DOUBLE":_listoftypes.push("d");break;default:_listoftypes.push("s");break;}}return _listoftypes;};_B.eqoperators=function(_sm) {var _BANp = gBANp(arguments);var _nl,_k;_nl=[];_nl.length=0;var _kKeys = Object.keys(_sm);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nl.push("=");}return _nl;};_B.updatewhere=function(_tblfields,_tblwhere,_operators) {var _BANp = gBANp(arguments);var _listoftypes,_listoftypes1,_listofvalues,_listofvalues1,_sb,_i,_itot,_col,_iwhere,_opr;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.UpdateWhere: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_BANp,_B);}_listoftypes=_B.getmaptypes(_tblfields,_BANp,_B);_listoftypes1=_B.getmaptypes(_tblwhere,_BANp,_B);_listoftypes.push(..._listoftypes1);_listofvalues=_B.getmapvalues(_tblfields,_BANp,_B);_listofvalues1=_B.getmapvalues(_tblwhere,_BANp,_B);_listofvalues.push(..._listofvalues1);_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("UPDATE " + _B.escapefield(_B._tablename,_BANp,_B) + " SET ");_i=0;_itot=Object.keys(_tblfields).length-1;for (_i=0;_i<=_itot;_i++) {_col=banano_getB4JKeyAt(_tblfields,_i);_sb.append(_B.escapefield(_col,_BANp,_B));if (_i!=_itot) {_sb.append(" = ?,");} else {_sb.append(" = ?");}}_sb.append(" WHERE ");_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_sb.append(_B.escapefield(_col,_BANp,_B));_opr=_operators[_i];_sb.append(" " + _opr + " ?");}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="update";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.updatewherewait=async function(_tblfields,_tblwhere,_operators) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.updatewhere(_tblfields,_tblwhere,_operators,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);return true;};_B.delete_where=function() {return _B.deletewhere(_B._wherefield,_B._ops,_B);};_B.deletewhere=function(_tblwhere,_operators) {var _BANp = gBANp(arguments);var _listoftypes,_listofvalues,_sb,_i,_iwhere,_col,_opr;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.DeleteWhere: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_BANp,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_BANp,_B);_listofvalues=_B.getmapvalues(_tblwhere,_BANp,_B);_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("DELETE FROM " + _B.escapefield(_B._tablename,_BANp,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_sb.append(_col);_opr=_operators[_i];_sb.append(" " + _opr + " ?");}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="delete";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.deleteall=function() {var _sb;_sb="DELETE FROM " + _B.escapefield(_B._tablename,_B) + " WHERE 1=1";_B._query=_sb;_B._command="delete";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.map2json=function(_mp) {var _xjson;_xjson={};_xjson=_mp;return JSON.stringify(_xjson);};_B.list2json=function(_mp) {var _xjson;_xjson={};_xjson=_mp;return JSON.stringify(_xjson);};_B.json2list=function(_strvalue) {var _lst,_parser;_lst=[];_lst.length=0;_lst.length=0;if (_strvalue.length==0) {return _lst;}try {_parser={};_parser=JSON.parse(_strvalue);return _parser;} catch(err) {return _lst;}};_B.updateall=function(_tblfields) {var _operators,_listoftypes,_listofvalues,_sb,_i,_itot,_oper,_col;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.UpdateAll: '" + _B._tablename + "' schema is not set!");}_operators=_B.eqoperators(_tblfields,_B);_listoftypes=_B.getmaptypes(_tblfields,_B);_listofvalues=_B.getmapvalues(_tblfields,_B);_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("UPDATE " + _B.escapefield(_B._tablename,_B) + " SET ");_i=0;_itot=Object.keys(_tblfields).length-1;for (_i=0;_i<=_itot;_i++) {_oper=_operators[_i];_col=banano_getB4JKeyAt(_tblfields,_i);_sb.append(_col);if (_i!=_itot) {_sb.append(" " + _oper + " ?,");} else {_sb.append(" " + _oper + " ?");}}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="update";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.updateallwait=async function(_rec) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.updateall(_rec,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);return true;};_B.read=function(_primaryvalue) {var _qw;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Read: '" + _B._tablename + "' schema is not set!");}_qw={};_qw[_B._primarykey]=_primaryvalue;_B.selectwhere(["*"],_qw,["="],[_B._primarykey],_B);return _B;};_B.readby=function(_pk,_pv) {_B._primarykey=_pk;_B.read(_pv,_B);};_B.readwait=async function(_pk) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.read(_pk,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return true;};_B.exists=function(_primaryvalue) {var _qw;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.Exists: '" + _B._tablename + "' schema is not set!");}_qw={};_qw[_B._primarykey]=_primaryvalue;_B.selectwhere([_B._primarykey],_qw,["="],[_B._primarykey],_B);return _B;};_B.getmaxwhere=function(_fldname,_tblwhere,_operators) {var _listoftypes,_listofvalues,_sb,_i,_iwhere,_col,_opr;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.GetMaxWhere: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_B);_listofvalues=_B.getmapvalues(_tblwhere,_B);_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT MAX([" + _fldname + "]) As [" + _fldname + "] FROM " + _B.escapefield(_B._tablename,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_sb.append(_col);_opr=_operators[_i];_sb.append(" " + _opr + " ?");}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.selectdistinctall=function(_tblfields,_orderby) {var _fld1,_selfields,_sb,_stro;if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT DISTINCT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_B) + "");if (true && _orderby.length>0) {_stro=_B.joinfields(",",_orderby,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._command="select";return _B;};_B.selectdistinctwhere=function(_tblfields,_tblwhere,_operators,_orderby) {var _listoftypes,_listofvalues,_fld1,_selfields,_sb,_i,_iwhere,_col,_oper,_stro;if (Object.keys(_B._schema).length==0) {console.log("SDUIMSSQLE.SelectDistinctWhere: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_B);_listofvalues=_B.getmapvalues(_tblwhere,_B);if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT DISTINCT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_oper=_operators[_i];_sb.append(_B.escapefield(_col,_B));_sb.append(" " + _oper + " ?");}if (true && _orderby.length>0) {_stro=_B.joinfields(",",_orderby,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.select_where=function() {return _B.selectwhere(_B._flds,_B._wherefield,_B._ops,_B._orderbyl,_B);};_B.selectwhere=function(_tblfields,_tblwhere,_operators,_orderby) {var _BANp = gBANp(arguments);var _listoftypes,_listofvalues,_fld1,_selfields,_sb,_i,_iwhere,_col,_opr,_stro;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.SelectWhere: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_BANp,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_BANp,_B);_listofvalues=_B.getmapvalues(_tblwhere,_BANp,_B);if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_BANp,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_BANp,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_sb.append(_col);_opr=_operators[_i];_sb.append(" " + _opr + " ?");}if (true && _orderby.length>0) {_stro=_B.joinfields(",",_orderby,_BANp,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_BANp,_B);_B._json="";_B._affectedrows=0;return _B;};_B.selectwherewait=async function(_tblfields,_tblwhere,_operators,_orderby) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.selectwhere(_tblfields,_tblwhere,_operators,_orderby,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return true;};_B.selectmaxwhere=function(_fld,_tblwhere,_operators) {var _listoftypes,_listofvalues,_sb,_i,_iwhere,_col,_opr;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.SelectMaxWhere: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_B);_listofvalues=_B.getmapvalues(_tblwhere,_B);_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT MAX(" + _fld + ") As [" + _fld + "] FROM " + _B.escapefield(_B._tablename,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_sb.append(_col);_opr=_operators[_i];_sb.append(" " + _opr + " ?");}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.andoroperators=function(_sm) {var _nl,_k;_nl=[];_nl.length=0;var _kKeys = Object.keys(_sm);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nl.push("AND");}return _nl;};_B.selectwhere1=function(_tblfields,_tblwhere,_operators,_andor,_orderby) {var _listoftypes,_listofvalues,_fld1,_selfields,_sb,_i,_iwhere,_sandor,_col,_opr,_stro;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.SelectWhere1: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_B);}if (is.null(_andor)) {_andor=_B.andoroperators(_tblwhere,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_B);_listofvalues=_B.getmapvalues(_tblwhere,_B);if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sandor=_andor[_i];_sb.append(" " + _sandor + " ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_sb.append(_col);_opr=_operators[_i];_sb.append(" " + _opr + " ?");}if (true && _orderby.length>0) {_stro=_B.joinfields(",",_orderby,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.selectwhere1wait=async function(_tblfields,_tblwhere,_operators,_andor,_orderby) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.selectwhere1(_tblfields,_tblwhere,_operators,_andor,_orderby,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return true;};_B.selectwhereascdesc=function(_tblfields,_tblwhere,_operators,_orderby,_ascdesc) {var _listoftypes,_listofvalues,_fld1,_selfields,_sb,_i,_iwhere,_col,_oper,_xorder,_obtot,_obcnt,_xfld,_stro;if (Object.keys(_B._schema).length==0) {console.log("SDUIAlaSQLE.SelectWhereAscDesc: '" + _B._tablename + "' schema is not set!");}if (is.null(_operators)) {_operators=_B.eqoperators(_tblwhere,_B);}_listoftypes=_B.getmaptypes(_tblwhere,_B);_listofvalues=_B.getmapvalues(_tblwhere,_B);if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_B) + " WHERE ");_i=0;_iwhere=Object.keys(_tblwhere).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_tblwhere,_i);_oper=_operators[_i];_sb.append(_B.escapefield(_col,_B));_sb.append(" " + _oper + " ?");}if (true && _orderby.length>0) {_xorder=[];_xorder.length=0;_obtot=_orderby.length-1;_obcnt=0;for (_obcnt=0;_obcnt<=_obtot;_obcnt++) {_xfld=_orderby[_obcnt];if (true && _ascdesc.length>0) {if (_ascdesc.indexOf(_xfld)>=0) {_xfld=_B.escapefield(_xfld,_B)+" DESC";_xorder.push(_xfld);}} else {_xorder.push(_B.escapefield(_xfld,_B));}}_stro=_B.join(",",_xorder,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._args=_listofvalues;_B._types=_listoftypes;_B._command="select";return _B;};_B.selectwhereascdescwait=async function(_tblfields,_tblwhere,_operators,_orderby,_ascdesc) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.selectwhereascdesc(_tblfields,_tblwhere,_operators,_orderby,_ascdesc,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return true;};_B.join=function(_delimiter,_lst) {var _i,_sb,_fld;_i=0;_sb=new StringBuilder();_fld="";_sb.init();_sb.isinitialized=true;_fld=_lst[0];_sb.append(_fld);for (_i=1;_i<=_lst.length-1;_i++) {_fld=_lst[_i];_sb.append(_delimiter).append(_fld);}return _sb.toString();};_B.selectall=function(_tblfields,_orderby) {var _fld1,_selfields,_sb,_stro;if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_B) + "");if (true && _orderby.length>0) {_stro=_B.joinfields(",",_orderby,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;return _B;};_B.selectallwait=async function(_tblfields,_orderby) {var _db;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.selectall(_tblfields,_orderby,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return true;};_B.selecteverything=function() {var _tblfields,_orderby;_tblfields=[];_tblfields.length=0;_tblfields.push("*");_orderby=[];_orderby.length=0;_B.selectall(_tblfields,_orderby,_B);return true;};_B.selecteverythingwait=async function() {var _tblfields,_orderby,_db;_tblfields=[];_tblfields.length=0;_tblfields.push("*");_orderby=[];_orderby.length=0;_db=null;_db_B._dbase=_B._dbase;await BananoSQLOpen(_B._dbase);_B.selectall(_tblfields,_orderby,_B);_B._result=await BananoSQLRunExecute(_B._query, _B._args,_db_B._dbase);_B.fromjson(_B);_B._rowcount=_B._result.length;_B._affectedrows=_B._rowcount;return _B._result;};_B.selectallascdesc=function(_tblfields,_orderby,_ascdesc) {var _fld1,_selfields,_sb,_xorder,_obtot,_obcnt,_xfld,_stro;if (_tblfields.length==0) {_tblfields.push("*");}_fld1=_tblfields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_tblfields,_B);break;}_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT " + _selfields + " FROM " + _B.escapefield(_B._tablename,_B) + "");if (true && _orderby.length>0) {_xorder=[];_xorder.length=0;_obtot=_orderby.length-1;_obcnt=0;for (_obcnt=0;_obcnt<=_obtot;_obcnt++) {_xfld=_orderby[_obcnt];if (true && _ascdesc.length>0) {if (_ascdesc.indexOf(_xfld)>=0) {_xfld=_B.escapefield(_xfld,_B)+" DESC";_xorder.push(_xfld);}} else {_xorder.push(_B.escapefield(_xfld,_B));}}_stro=_B.join(",",_xorder,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_B._query=_sb.toString();_B._command="select";_B._response="";_B._error="";_B._result=_B.newlist(_B);_B._json="";_B._affectedrows=0;};_B.setposition=function(_pos) {if (_B._result.length>_pos) {_B._record=_B._result[_pos];_B._lastposition=_pos;} else {_B._lastposition=-1;_B._record={};}_B._recordjson=JSON.stringify(_B._record);};_B.getposition=function() {return _B._lastposition;};_B.getint=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return 0;}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? 0:_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cint(_obj);return _obj;} else {return 0;}};_B.getlong=function(_fld) {return _B.getint(_fld,_B);};_B.getstring=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return "";}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? "":_B._record[_fld];_obj=_B.cstr(_obj,_B);return _obj;} else {return "";}};_B.getboolean=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return false;}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? false:_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cbool(_obj);return _obj;} else {return false;}};_B.getdouble=function(_fld) {var _obj;_fld=_fld.toLowerCase();if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? 0:_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cdbl(_obj);return _obj;} else {return 0;}};_B.getrecord=function(_pos) {var _rec;_rec=_B._result[_pos];return _rec;};_B.movestart=function() {_B._lastposition=-1;};_B.movefirst=function() {_B.setposition(0,_B);};_B.movelast=function() {_B.setposition(_B._rowcount-1,_B);};_B.moveprevious=function() {_B._lastposition=_B._lastposition-1;if (_B._lastposition<0) {_B._lastposition=0;}_B.setposition(_B._lastposition,_B);};_B.movenext=function() {_B._lastposition=_B._lastposition+1;if (_B._lastposition>_B._rowcount) {_B._lastposition=_B._rowcount-1;}_B.setposition(_B._lastposition,_B);};}function banano_sithasodaisyalasqle_sduikeystore() {var _B=this;_B._db=null;_B._sdb="";_B._wherefield={};_B._ops=[];_B._orderbyl=[];_B._flds=[];_B._rowcount=0;_B._lastposition=0;_B._record={};_B._result=[];_B._usebrackets=false;_B.initialize=async function(_dbname) {var _xname;_B._sdb=_dbname;_xname=_dbname;_B._db_xname=_xname;await BananoSQLOpen(_xname);await _B.createtable(_B);_B._wherefield={};_B._ops.length=0;_B._orderbyl.length=0;_B._flds.length=0;_B._record={};_B._lastposition=-1;_B._result=await _B.records(_B);_B._usebrackets=false;return _B;};_B.setfield=function(_fldname,_fldvalue) {_B._record[_fldname]=_fldvalue;return _B;};_B.recordfrommap=function(_sm) {var _k,_v;_B._record={};var _kKeys = Object.keys(_sm);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_sm[_k];_B._record[_k]=_v;}};_B.firstrecord=function() {var _rec;_rec=_B._result[0];return _rec;};_B.clear_where=function() {_B._wherefield={};_B._ops.length=0;_B._orderbyl.length=0;_B._flds.length=0;return _B;};_B.add_field=function(_fld) {_B._flds.push(_fld);return _B;};_B.add_fields=function(_fields) {var _fld;for (var _fldindex=0;_fldindex<_fields.length;_fldindex++) {_fld=_fields[_fldindex];_B.add_field(_fld,_B);}return _B;};_B.add_where=function(_fld,_operator,_value) {_B._wherefield[_fld]=_value;_B._ops.push(_operator);return _B;};_B.add_order_by=function(_fld) {_B._orderbyl.push(_fld);return _B;};_B.createtable=async function() {var _rs;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.schemacreatetable();_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_rs=null;};_B.deleteall=async function() {var _rs;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.droptable();_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_rs=null;await _B.createtable(_B);};_B.containskey=async function(_key) {var _rs,_fw;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_fw={};_fw["k"]=_key;_rs.selectwhere(["k"],_fw,["="],["k"]);_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();if (_rs._affectedrows>0) {return true;} else {return false;}};_B.select_where=function() {return _B.findwhereorderby(_B._flds,_B._wherefield,_B._ops,_B._orderbyl,_B);};_B.put=async function(_key,_value) {var _bthere,_vtojson,_rs;_bthere=await _B.containskey(_key,_B);_vtojson=JSON.stringify(_value);_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.preparerecord();_rs.setfield("k",_key);_rs.setfield("v",_vtojson);if (_bthere) {_rs.update(_key);} else {_rs.insert();}_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_rs=null;return true;};_B.get=async function(_key) {var _resultx,_vfromjson,_rs,_fw;_resultx=null;_vfromjson="";_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_fw={};_fw["k"]=_key;_rs.selectwhere(["v"],_fw,["="],["k"]);_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();if (_rs.nextrow()) {_rs.movefirst();_resultx=_rs.getstring("v");_vfromjson=JSON.parse(_resultx);_resultx=_vfromjson;}_rs=null;return _resultx;};_B.getmapasync=async function(_keys) {var _sb,_i,_rs,_m,_k,_v;_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_sb.append("SELECT k, v FROM main WHERE ");for (_i=0;_i<=_keys.length-1;_i++) {if (_i>0) {_sb.append(" OR ");}_sb.append(" k = ? ");}_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.execute(_sb.toString());_rs._result=await BananoSQLRunExecute(_rs._query, _keys,_B._db_xname);_rs.fromjson();_m={};_m={};while (_rs.nextrow()) {_k=_rs.getstring("k");_v=_rs.getstring("v");_v=JSON.parse(_v);_m[_k]=_v;}_rs=null;return _m;};_B.getmapallasync=async function() {var _rs,_m,_k,_v;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.selecteverything();_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_m={};_m={};while (_rs.nextrow()) {_k=_rs.getstring("k");_v=_rs.getstring("v");_v=JSON.parse(_v);_m[_k]=_v;}_rs=null;return _m;};_B.records=async function() {var _rs,_v;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.selecteverything();_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_B._result.length=0;while (_rs.nextrow()) {_v=_rs.getstring("v");_v=JSON.parse(_v);_B._result.push(_v);}_B._lastposition=-1;_B._rowcount=_B._result.length;return _B._result;};_B.findwhere=async function(_wheremap,_whereops) {var _sb,_args,_recs,_i,_iwhere,_col,_val,_opr,_sout,_res;_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_args=[];_args.length=0;_recs=await _B.records(_B);_args.push(_recs);_sb.append("SELECT * FROM ? WHERE ");_i=0;_iwhere=Object.keys(_wheremap).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_wheremap,_i);_val=banano_getB4JValueAt(_wheremap,_i);_opr=_whereops[_i];_sb.append(_col);_sb.append(" " + _opr + " ?");_args.push(_val);}_sout=_sb.toString();_res=await BananoSQLRunExecute(_sout, _args,_B._db_xname);return _res;};_B.findwhereorderby=async function(_fields,_wheremap,_whereops,_orderby) {var _sb,_args,_recs,_fld1,_selfields,_i,_iwhere,_col,_val,_opr,_stro,_sout,_res;_sb=new StringBuilder();_sb.init();_sb.isinitialized=true;_args=[];_args.length=0;_recs=await _B.records(_B);_args.push(_recs);if (_fields.length==0) {_fields.push("*");}_fld1=_fields[0];_selfields="";switch ("" + _fld1) {case "" + "*":_selfields="*";break;default:_selfields=_B.joinfields(",",_fields,_B);break;}_sb.append("SELECT " + _selfields + " FROM ? WHERE ");_i=0;_iwhere=Object.keys(_wheremap).length-1;for (_i=0;_i<=_iwhere;_i++) {if (_i>0) {_sb.append(" AND ");}_col=banano_getB4JKeyAt(_wheremap,_i);_val=banano_getB4JValueAt(_wheremap,_i);_opr=_whereops[_i];_sb.append(_col);_sb.append(" " + _opr + " ?");_args.push(_val);}if (true && _orderby.length>0) {_stro=_B.joinfields(",",_orderby,_B);if (_stro.length>0) {_sb.append(" ORDER BY ").append(_stro);}}_sout=_sb.toString();_res=await BananoSQLRunExecute(_sout, _args,_B._db_xname);return _res;};_B.escapefield=function(_f) {if (_B._usebrackets) {return "[" + _f + "]";} else {return _f;}};_B.joinfields=function(_delimiter,_lst) {var _i,_sb,_fld;_i=0;_sb=new StringBuilder();_fld="";_sb.init();_sb.isinitialized=true;_fld=_lst[0];_fld=_B.escapefield(_fld,_B);_sb.append(_fld);for (_i=1;_i<=_lst.length-1;_i++) {_fld=_lst[_i];_fld=_B.escapefield(_fld,_B);_sb.append(_delimiter).append(_fld);}return _sb.toString();};_B.deletewhere=async function(_prikey,_wheremap,_whereops) {var _recs,_rec,_pvalue;_recs=await _B.findwhere(_wheremap,_whereops,_B);for (var _recindex=0;_recindex<_recs.length;_recindex++) {_rec=_recs[_recindex];_pvalue=_rec[_prikey];await _B.remove(_pvalue,_B);}return true;};_B.putmapasync=async function(_thismap) {var _k,_v;var _kKeys = Object.keys(_thismap);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_thismap[_k];await _B.put(_k,_v,_B);}return true;};_B.getdefault=async function(_key,_defaultvalue) {var _res;_res=await _B.get(_key,_B);if (_res==null) { return _defaultvalue;}return _res;};_B.listkeys=async function() {var _rs,_res;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.selectall(["k"],["k"]);_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_res=[];_res.length=0;while (_rs.nextrow()) {_res.push(_rs.getstring("k"));}_rs=null;return _res;};_B.remove=async function(_key) {var _rs;_rs=(typeof banano_sithasodaisyalasqle_sduialasqle === 'function') ? new banano_sithasodaisyalasqle_sduialasqle(): null;_rs.initialize(_B._sdb,"main","k","");_rs.schemaaddtext(["k","v"]);_rs.delete(_key);_rs._result=await BananoSQLRunExecute(_rs._query, _rs._args,_B._db_xname);_rs.fromjson();_rs=null;};_B.nextrow=function() {var _realsize;_B._lastposition=_B._lastposition+1;_realsize=_B._rowcount-1;if (_B._lastposition>_realsize) {return false;} else {_B.setposition(_B._lastposition,_B);return true;}};_B.setrecord=function(_rec) {var _k,_v;var _kKeys = Object.keys(_rec);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_rec[_k];_B.setfield(_k,_v,_B);}};_B.preparerecord=function() {_B._record={};};_B.setposition=function(_pos) {if (_B._result.length>_pos) {_B._record=_B._result[_pos];_B._lastposition=_pos;} else {_B._lastposition=-1;_B._record={};}};_B.getposition=function() {return _B._lastposition;};_B.getint=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return 0;}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? 0:_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cint(_obj);return _obj;} else {return 0;}};_B.getlong=function(_fld) {return _B.getint(_fld,_B);};_B.getstring=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return "";}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? "":_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cstr(_obj);return _obj;} else {return "";}};_B.getboolean=function(_fld) {var _obj;_fld=_fld.toLowerCase();if (is.undefined(_B._record)) { return false;}if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? false:_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cbool(_obj);return _obj;} else {return false;}};_B.getdouble=function(_fld) {var _obj;_fld=_fld.toLowerCase();if ((_fld in _B._record)) {_obj=_B._record[_fld]===undefined? 0:_B._record[_fld];_obj=_banano_sithasodaisyalasqle_modala.cdbl(_obj);return _obj;} else {return 0;}};_B.getrecord=function(_pos) {var _rec;_rec=_B._result[_pos];return _rec;};_B.movestart=function() {_B._lastposition=-1;};_B.movefirst=function() {_B.setposition(0,_B);};_B.movelast=function() {_B.setposition(_B._rowcount-1,_B);};_B.moveprevious=function() {_B._lastposition=_B._lastposition-1;if (_B._lastposition<0) {_B._lastposition=0;}_B.setposition(_B._lastposition,_B);};_B.movenext=function() {_B._lastposition=_B._lastposition+1;if (_B._lastposition>_B._rowcount) {_B._lastposition=_B._rowcount-1;}_B.setposition(_B._lastposition,_B);};}function banano_sithasodaisyalasqle_sithasodaisyalasqe() {var _B=this;}