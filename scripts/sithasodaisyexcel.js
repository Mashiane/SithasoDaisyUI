
/* sithasodaisyexcel */
function banano_sithasodaisyexcel_sduiexcel() {var _B=this;_B.__164=null;_B._oxml=null;_B._xlsx=null;_B.__167=[];_B.__168=[];_B.__169="";_B.__182="thick";_B.__183="none";_B.__184="thin";_B.__185="medium";_B.__186="dashed";_B.__187="dotted";_B.__188="double";_B.__189="hair";_B.__18a="mediumDashed";_B.__18b="dashDot";_B.__18c="mediumDashDot";_B.__18d="dashDotDot";_B.__18e="mediumDashDotDot";_B.__18f="slantDashDot";_B.__190="F44336";_B.__191="E91E63";_B.__192="9C27B0";_B.__193="673AB7";_B.__194="3F51B5";_B.__195="2196F3";_B.__196="03A9F4";_B.__197="00BCD4";_B.__198="009688";_B.__199="4CAF50";_B.__19a="8BC34A";_B.__19b="CDDC39";_B.__19c="ffe821";_B.__19d="FFC107";_B.__19e="FF9800";_B.__19f="FF5722";_B.__1a0="795548";_B.__1a1="9E9E9E";_B.__1a2="607D8B";_B.__1a3="000000";_B.__1a4="ffffff";_B.__1a5="transparent";_B.__1a6="darkDown";_B.__1a7="darkGray";_B.__1a8="darkGrid";_B.__1a9="darkHorizontal";_B.__1aa="darkTrellis";_B.__1ab="darkUp";_B.__1ac="darkVertical";_B.__1ad="gray0625";_B.__1ae="gray125";_B.__1af="lightDown";_B.__1b0="lightGray";_B.__1b1="lightGrid";_B.__1b2="lightHorizontal";_B.__1b3="lightTrellis";_B.__1b4="lightUp";_B.__1b5="lightVertical";_B.__1b6="mediumGray";_B.__1b7="none";_B.__1b8="solid";_B.__1b9={};_B._rows=[];_B.__154={};_B.__1bb="";_B.initialize=function(__acf,__b6d,__3ce) {_B.__154=__acf;_B.__1bb=__b6d;;;;_B._oxml=oxml;_B.__164=_B._oxml["xlsx"]();_B.__169=__3ce;_B.__1b9={};_B._rows.length=0;};_B.addcolumn=function(__b52,__ba0) {_B.__1b9[__b52]=__ba0;};_B.addcolumns=function(_ws,_m) {var _k,_v;var _kKeys = Object.keys(_m);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_m[_k];_B.addcolumn(_k,_v,_B);}_B.setcolumns(_ws,1,_B);};_B.clearcolumns=function() {_B.__1b9={};};_B.clearrows=function() {_B._rows.length=0;};_B.setheaderfields=function(_flds) {var __ba2,_fldcnt,__b02;__ba2=_flds.length-1;__ba3=0;for (_fldcnt=0;_fldcnt<=__ba2;_fldcnt++) {__b02=_flds[_fldcnt];_B.addcolumn(__b02,__b02,_B);}};_B.setheadertitles=function(_flds) {var __ba2,_fldcnt,__b02;__ba2=_flds.length-1;__ba3=0;for (_fldcnt=0;_fldcnt<=__ba2;_fldcnt++) {__b02=_flds[_fldcnt];_B.addcolumn(__b02,__b02,_B);}};_B.setcolumns=function(__ba4,__ba5) {var __ba6,_colcnt,__ba8,__ba9;__ba6=[];__ba6.length=0;__ba7=0;__ba8=Object.keys(_B.__1b9).length-1;for (_colcnt=0;_colcnt<=__ba8;_colcnt++) {__ba9=banano_getB4JValueAt(_B.__1b9,_colcnt);__ba6.push(__ba9);}_B.setrow(__ba4,__ba5,1,__ba6,_B);};_B.setrowsfromdatatable=function(_recs) {var _reccnt,__bab,__bac,__bad,_hdrn,_v;__baa=0;__bab=_recs.length-1;for (_reccnt=0;_reccnt<=__bab;_reccnt++) {__bac=_recs[_reccnt];__bad=[];__bad.length=0;var _hdrnKeys = Object.keys(_B.__1b9);for (var _hdrnindex=0;_hdrnindex<_hdrnKeys.length;_hdrnindex++) {_hdrn=_hdrnKeys[_hdrnindex];_hdrn=_hdrn.toLowerCase();_v=__bac[_hdrn];_v=_B.cstr(_v,_B);_v=_v.trim();__bad.push(_v);}_B._rows.push(__bad);}};_B.setcolumnsfromdatatable=function(__bae) {var __baf,__ba8,_colcnt,_hdr,__bb1,__27b;__baf=[];__baf.length=0;__ba8=Object.keys(__bae).length-1;__ba7=0;for (_colcnt=0;_colcnt<=__ba8;_colcnt++) {_hdr=banano_getB4JValueAt(__bae,_colcnt);__bb1=_hdr._name;__27b=_hdr.__343;switch ("" + _hdr.__16a) {case "" + "action":case "" + "edit":case "" + "delete":case "" + "print":case "" + "delete":case "" + "clone":case "" + "save":case "" + "cancel":case "" + "button":case "" + "menu":break;default:_B.__1b9[__bb1]=__27b;break;}}};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.readfromarraybuffer=function(__2e) {var _opt;;_B.__1b9={};_B._rows.length=0;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__164=_B._xlsx["read"](__2e,_opt);_B.__167=_B.__164["SheetNames"];_B.__168=_B.__164["Sheets"];};_B.readsheetcontentsbypos=function(_pos) {var __bb2,__ba4,__bb3,__bb4;__bb2=_B.__167[_pos];__ba4=_B.__168[__bb2];__bb3={};__bb3["defval"]="";__bb3["dateNF"]="yyyy-mm-dd hh:mm:ss";__bb4=_B._xlsx["utils"]["sheet_to_row_object_array"](__ba4,__bb3);return __bb4;};_B.getsinglecode=function(_lst) {var __bb5,__bb6,__bb7,_r1,_k,_nk;__bb5=new StringBuilder();__bb5.init();__bb5.isinitialized=true;__bb6=new StringBuilder();__bb6.init();__bb6.isinitialized=true;__bb5.append("'create a new record").append("\n");__bb5.append("Dim item As Map").append("\n");__bb5.append("item.Initialize").append("\n");__bb7=new StringBuilder();__bb7.init();__bb7.isinitialized=true;__bb7.append("For Each r As Map In records").append("\n");_r1=_lst[0];var _kKeys = Object.keys(_r1);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nk=_banano_sithasodaisy_sduishared.alphanumeric(_k);_nk=_nk.trim();__bb7.append("Dim s" + _nk + " As String = r.GetDefault(\"" + _k + "\", \"\")").append("\n");__bb5.append("item.put(\"" + _nk + "\", s" + _nk + ")").append("\n");__bb6.append("s" + _nk + " = SDUIShared.CStr(s" + _nk + ")").append("\n");__bb6.append("s" + _nk + " = s" + _nk + ".Trim").append("\n");}__bb7.append(__bb6.toString());__bb7.append(__bb5.toString());__bb7.append("Next").append("\n");return __bb7.toString();};_B.readfile=function(__2e) {var _BANp = gBANp(arguments);var _opt,__bb2,__ba4,__bb3,__bb4;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__164=_B._xlsx["read"](__2e,_opt);_B.__167=_B.__164["SheetNames"];__bb2=_B.__167[0];_B.__168=_B.__164["Sheets"];__ba4=_B.__168[__bb2];__bb3={};__bb3["defval"]="";__bb3["dateNF"]="yyyy-mm-dd hh:mm:ss";__bb4=_B._xlsx["utils"]["sheet_to_row_object_array"](__ba4,__bb3);return __bb4;};_B.readfileworksheet=function(__2e,_ws) {var _xlsx,_opt,__bb2,__ba4,__bb3,__bb4;_xlsx=null;_xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__164=_xlsx["read"](__2e,_opt);_B.__167=_B.__164["SheetNames"];__bb2=_B.__167[_ws];_B.__168=_B.__164["Sheets"];__ba4=_B.__168[__bb2];__bb3={};__bb3["defval"]="";__bb3["dateNF"]="yyyy-mm-dd hh:mm:ss";__bb4=_xlsx["utils"]["sheet_to_row_object_array"](__ba4,__bb3);return __bb4;};_B.createstyle=function() {var _s;_s= new banano_sithasodaisyexcel_oxmlstyle();_s.initialize();_s._bold=false;_s.__172=false;_s.__173=false;_s.__174=false;_s.__175=false;_s.__176="";_s.__177="";_s.__178="";_s.__179="";_s.__17a="";_s.__17b="";_s.__17d="";_s.__17e="";_s.__17f="";_s.__180="";_s.__181="";return _s;};_B.setstyleborder=function(_rc,__17b,__17c) {var __bba,_obj;__bba={};__bba["color"]=__17b;__bba["style"]=__17c;_obj={};_obj["border"]=__bba;_rc["style"](_obj);return _B;};_B.setstylenumberformat=function(_rc,_nf) {var _obj;_obj={};_obj["numberFormat"]=_nf;_rc["style"](_obj);return _B;};_B.setstylebold=function(_rc,_b) {var _obj;_obj={};_obj["bold"]=_b;_rc["style"](_obj);return _B;};_B.setstyleitalic=function(_rc,_b) {var _obj;_obj={};_obj["italic"]=_b;_rc["style"](_obj);return _B;};_B.setstyleunderline=function(_rc,_b) {var _obj;_obj={};_obj["underline"]=_b;_rc["style"](_obj);return _B;};_B.setstylefontsize=function(_rc,_fs) {var _obj;_obj={};_obj["fontSize"]=_fs;_rc["style"](_obj);return _B;};_B.setstylevalignment=function(_rc,_va) {var _obj;_obj={};_obj["vAlignment"]=_va;_rc["style"](_obj);return _B;};_B.setstylehalignment=function(_rc,_ha) {var _obj;_obj={};_obj["hAlignment"]=_ha;_rc["style"](_obj);return _B;};_B.setstyle=function(_rc,__16d) {var _obj,__bba,_fill;_obj={};if (__16d._bold) {_obj["bold"]=__16d._bold;}if (__16d.__172) {_obj["italic"]=__16d.__172;}if (__16d.__173) {_obj["underline"]=__16d.__173;}if (__16d.__174) {_obj["strike"]=__16d.__174;}if (__16d.__175) {_obj["fontSize"]=__16d.__175;}if (__16d.__176!="") {_obj["fontColor"]=__16d.__176;}if (__16d.__177!="") {_obj["fontName"]=__16d.__177;}if (__16d.__178!="") {_obj["fontFamily"]=__16d.__178;}if (__16d.__179!="") {_obj["scheme"]=__16d.__179;}if (__16d.__17a!="") {_obj["numberFormat"]=__16d.__17a;}if (__16d.__17e!="") {_obj["vAlignment"]=__16d.__17e;}if (__16d.__17d!="") {_obj["hAlignment"]=__16d.__17d;}if (__16d.__17b!="" || __16d.__17c!="") {__bba={};__bba["color"]=__16d.__17b;__bba["style"]=__16d.__17c;_obj["border"]=__bba;}if (__16d.__17f!="" && __16d.__180!="" && __16d.__181!="") {_fill={};_fill["pattern"]=__16d.__17f;_fill["foreColor"]=__16d.__180;_fill["backColor"]=__16d.__181;_obj["fill"]=_fill;}_rc["style"](_obj);};_B.merge=function(__ba4,__746) {__ba4["merge"](__746);return _B;};_B.getrow=function(__ba4,__ba5,__bbf) {var _row;_row=__ba4["row"](__ba5,__bbf);return _row;};_B.getcolumn=function(__ba4,__ba5,__bbf) {var _colx;_colx=__ba4["column"](__ba5,__bbf);return _colx;};_B.getcell=function(__ba4,__ba5,__bbf) {var _colx;_colx=__ba4["cell"](__ba5,__bbf);return _colx;};_B.createrow=function(__ba5,__bbf) {var _row;_row= new banano_sithasodaisyexcel_oxmlrow();_row.initialize();_row.__16f=__bbf;_row.__16e=__ba5;_row.__170.length=0;_row.__16d={};return _row;};_B.createformula=function(__16c) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__16a="formula";_cell.__16c=__16c;_cell.__16d={};return _cell;};_B.createtext=function(__16b) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__16a="string";_cell.__16b=__16b;_cell.__16d={};return _cell;};_B.createnumber=function(__16b) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__16a="numeric";_cell.__16b=__16b;_cell.__16d={};return _cell;};_B.createsharedtext=function(__16b) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__16a="sharedString";_cell.__16b=__16b;_cell.__16d={};return _cell;};_B.cell2map=function(_cell) {var _m;_m={};_m["type"]=_cell.__16a;_m["value"]=_cell.__16b;if (_cell.__16c!="") {_m["formula"]=_cell.__16c;}return _m;};_B.worksheet=function(__bc3) {var __bc4;__bc4=null;__bc4=_B.__164["sheet"](__bc3);return __bc4;};_B.addworksheet=function(__bc3) {var _bo;_bo=_B.worksheet(__bc3,_B);return _bo;};_B.setrow=function(__ba4,__ba5,__bbf,__170) {__ba4["row"](__ba5,__bbf,__170);};_B.setcolumn=function(__ba4,__ba5,__bbf,__170) {__ba4["column"](__ba5,__bbf,__170);};_B.setrowbo=function(_row,__170) {_row["set"](__170);};_B.setcolbo=function(_col,__170) {_col["set"](__170);};_B.setrow1=function(__ba4,_row) {var __ba5,__bbf,__170;__ba5=_row.__16e;__bbf=_row.__16f;__170=_row.__170;_B.setrow(__ba4,__ba5,__bbf,__170,_B);};_B.download=async function(__acf,__2ba) {var _res,_err,_prom,_args;_res={};_err={};_prom=_B.__164["download"](_B.__169);await _prom;_prom.then(function(_res) {_args=[];_prom=BANanoPromise();__acf[(__2ba).toLowerCase()](_args,_prom,_B);}).catch(function(_err) {});};_B.addrowtext=function(_row,__16b) {var _cell;_cell=_B.cell2map(_B.createtext(__16b,_B),_B);_row.__170.push(_cell);return _B;};_B.addrownumber=function(_row,__16b) {var _cell;_cell=_B.cell2map(_B.createnumber(__16b,_B),_B);_row.__170.push(_cell);return _B;};_B.addrowsharedtext=function(_row,__16b) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__16b,_B),_B);_row.__170.push(_cell);return _B;};_B.addrowformula=function(_row,__16c) {var _cell;_cell=_B.cell2map(_B.createformula(__16c,_B),_B);_row.__170.push(_cell);return _B;};_B.addrowformula1=function(_row,__16c,__16b) {var _cell,__bc7;_cell=_B.createformula(__16c,_B);_cell.__16b=__16b;__bc7=_B.cell2map(_cell,_B);_row.__170.push(__bc7);return _B;};_B.settext=function(__ba4,__ba5,__bbf,__16b) {var _cell;_cell=_B.cell2map(_B.createtext(__16b,_B),_B);__ba4["cell"](__ba5,__bbf)["set"](_cell);};_B.setcelltext=function(__bc8,__16b) {var _cell;_cell=_B.cell2map(_B.createtext(__16b,_B),_B);__bc8["set"](_cell);};_B.setcellnumber=function(__bc8,__16b) {var _cell;_cell=_B.cell2map(_B.createnumber(__16b,_B),_B);__bc8["set"](_cell);};_B.setnumber=function(__ba4,__ba5,__bbf,__16b) {var _cell;_cell=_B.cell2map(_B.createnumber(__16b,_B),_B);__ba4["cell"](__ba5,__bbf)["set"](_cell);};_B.setcellsharedtext=function(__bc8,__16b) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__16b,_B),_B);__bc8["set"](_cell);};_B.setsharedtext=function(__ba4,__ba5,__bbf,__16b) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__16b,_B),_B);__ba4["cell"](__ba5,__bbf)["set"](_cell);};_B.setcellformula=function(__bc8,__16c) {var _cell;_cell=_B.cell2map(_B.createformula(__16c,_B),_B);__bc8["set"](_cell);};_B.setformula=function(__ba4,__ba5,__bbf,__16c) {var _cell;_cell=_B.cell2map(_B.createformula(__16c,_B),_B);__ba4["cell"](__ba5,__bbf)["set"](_cell);};_B.setcellformula1=function(__bc8,__16c,__16b) {var _cell,__bc7;_cell=_B.createformula(__16c,_B);_cell.__16b=__16b;__bc7=_B.cell2map(_cell,_B);__bc8["set"](__bc7);};_B.setformula1=function(__ba4,__ba5,__bbf,__16c,__16b) {var _cell,__bc7;_cell=_B.createformula(__16c,_B);_cell.__16b=__16b;__bc7=_B.cell2map(_cell,_B);__ba4["cell"](__ba5,__bbf)["set"](__bc7);};_B.exporttable=function(__bc9,__bba,__70d,__bca,__395) {var _ws,__bcb,_rec,__bcc,_rowstart,__bcf,_rptr;_ws=_B.addworksheet("Sheet1",_B);_B.settext(_ws,1,1,__bc9,_B);_B.setrow(_ws,2,1,__bca,_B);__bcb=3;for (var _recindex=0;_recindex<__395.length;_recindex++) {_rec=__395[_recindex];__bcc=_banano_sithasodaisy_sduishared.getlistfrommapkeys(_rec,__70d);_B.setrow(_ws,__bcb,1,__bcc,_B);__bcb=__bcb+1;}if (__bba) {__bce=0;__bcf=_B.createstyle(_B);__bcf.__17b=_B.__1a3;__bcf.__17c=_B.__184;for (_rowstart=2;_rowstart<=__bcb;_rowstart++) {__bcf._bold=false;_rptr=_B.getrow(_ws,_rowstart,1,_B);if (_rowstart==2) {__bcf._bold=true;}_B.setstyle(_rptr,__bcf,_B);}}_B.download(_B.__154,"" + _B.__1bb + "_exceldownload",_B);};}