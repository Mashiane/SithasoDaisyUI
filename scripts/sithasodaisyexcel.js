
/* sithasodaisyexcel */
function banano_sithasodaisyexcel_sduiexcel() {var _B=this;_B.__15d=null;_B._oxml=null;_B._xlsx=null;_B.__160=[];_B.__161=[];_B.__162="";_B.__17b="thick";_B.__17c="none";_B.__17d="thin";_B.__17e="medium";_B.__17f="dashed";_B.__180="dotted";_B.__181="double";_B.__182="hair";_B.__183="mediumDashed";_B.__184="dashDot";_B.__185="mediumDashDot";_B.__186="dashDotDot";_B.__187="mediumDashDotDot";_B.__188="slantDashDot";_B.__189="F44336";_B.__18a="E91E63";_B.__18b="9C27B0";_B.__18c="673AB7";_B.__18d="3F51B5";_B.__18e="2196F3";_B.__18f="03A9F4";_B.__190="00BCD4";_B.__191="009688";_B.__192="4CAF50";_B.__193="8BC34A";_B.__194="CDDC39";_B.__195="ffe821";_B.__196="FFC107";_B.__197="FF9800";_B.__198="FF5722";_B.__199="795548";_B.__19a="9E9E9E";_B.__19b="607D8B";_B.__19c="000000";_B.__19d="ffffff";_B.__19e="transparent";_B.__19f="darkDown";_B.__1a0="darkGray";_B.__1a1="darkGrid";_B.__1a2="darkHorizontal";_B.__1a3="darkTrellis";_B.__1a4="darkUp";_B.__1a5="darkVertical";_B.__1a6="gray0625";_B.__1a7="gray125";_B.__1a8="lightDown";_B.__1a9="lightGray";_B.__1aa="lightGrid";_B.__1ab="lightHorizontal";_B.__1ac="lightTrellis";_B.__1ad="lightUp";_B.__1ae="lightVertical";_B.__1af="mediumGray";_B.__1b0="none";_B.__1b1="solid";_B.__1b2={};_B._rows=[];_B.__14d={};_B.__1b4="";_B.initialize=function(__a6e,__b0b,__3c0) {_B.__14d=__a6e;_B.__1b4=__b0b;;;;_B._oxml=oxml;_B.__15d=_B._oxml["xlsx"]();_B.__162=__3c0;_B.__1b2={};_B._rows.length=0;};_B.addcolumn=function(__af1,__b30) {_B.__1b2[__af1]=__b30;};_B.addcolumns=function(_ws,_m) {var _k,_v;var _kKeys = Object.keys(_m);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_m[_k];_B.addcolumn(_k,_v,_B);}_B.setcolumns(_ws,1,_B);};_B.clearcolumns=function() {_B.__1b2={};};_B.clearrows=function() {_B._rows.length=0;};_B.setheaderfields=function(_flds) {var __b32,_fldcnt,__aa1;__b32=_flds.length-1;__b33=0;for (_fldcnt=0;_fldcnt<=__b32;_fldcnt++) {__aa1=_flds[_fldcnt];_B.addcolumn(__aa1,__aa1,_B);}};_B.setheadertitles=function(_flds) {var __b32,_fldcnt,__aa1;__b32=_flds.length-1;__b33=0;for (_fldcnt=0;_fldcnt<=__b32;_fldcnt++) {__aa1=_flds[_fldcnt];_B.addcolumn(__aa1,__aa1,_B);}};_B.setcolumns=function(__b34,__b35) {var __b36,_colcnt,__b38,__b39;__b36=[];__b36.length=0;__b37=0;__b38=Object.keys(_B.__1b2).length-1;for (_colcnt=0;_colcnt<=__b38;_colcnt++) {__b39=banano_getB4JValueAt(_B.__1b2,_colcnt);__b36.push(__b39);}_B.setrow(__b34,__b35,1,__b36,_B);};_B.setrowsfromdatatable=function(_recs) {var _reccnt,__b3b,__b3c,__b3d,_hdrn,_v;__b3a=0;__b3b=_recs.length-1;for (_reccnt=0;_reccnt<=__b3b;_reccnt++) {__b3c=_recs[_reccnt];__b3d=[];__b3d.length=0;var _hdrnKeys = Object.keys(_B.__1b2);for (var _hdrnindex=0;_hdrnindex<_hdrnKeys.length;_hdrnindex++) {_hdrn=_hdrnKeys[_hdrnindex];_hdrn=_hdrn.toLowerCase();_v=__b3c[_hdrn];_v=_B.cstr(_v,_B);_v=_v.trim();__b3d.push(_v);}_B._rows.push(__b3d);}};_B.setcolumnsfromdatatable=function(__b3e) {var __b3f,__b38,_colcnt,_hdr,__b41,__26d;__b3f=[];__b3f.length=0;__b38=Object.keys(__b3e).length-1;__b37=0;for (_colcnt=0;_colcnt<=__b38;_colcnt++) {_hdr=banano_getB4JValueAt(__b3e,_colcnt);__b41=_hdr._name;__26d=_hdr.__335;switch ("" + _hdr.__163) {case "" + "action":case "" + "edit":case "" + "delete":case "" + "print":case "" + "delete":case "" + "clone":case "" + "save":case "" + "cancel":case "" + "button":case "" + "menu":break;default:_B.__1b2[__b41]=__26d;break;}}};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.readfromarraybuffer=function(__3d) {var _opt;;_B.__1b2={};_B._rows.length=0;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__15d=_B._xlsx["read"](__3d,_opt);_B.__160=_B.__15d["SheetNames"];_B.__161=_B.__15d["Sheets"];};_B.readsheetcontentsbypos=function(_pos) {var __b42,__b34,__b43,__b44;__b42=_B.__160[_pos];__b34=_B.__161[__b42];__b43={};__b43["defval"]="";__b43["dateNF"]="yyyy-mm-dd hh:mm:ss";__b44=_B._xlsx["utils"]["sheet_to_row_object_array"](__b34,__b43);return __b44;};_B.getsinglecode=function(_lst) {var __b45,__b46,__b47,_r1,_k,_nk;__b45=new StringBuilder();__b45.init();__b45.isinitialized=true;__b46=new StringBuilder();__b46.init();__b46.isinitialized=true;__b45.append("'create a new record").append("\n");__b45.append("Dim item As Map").append("\n");__b45.append("item.Initialize").append("\n");__b47=new StringBuilder();__b47.init();__b47.isinitialized=true;__b47.append("For Each r As Map In records").append("\n");_r1=_lst[0];var _kKeys = Object.keys(_r1);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nk=_banano_sithasodaisy_sduishared.alphanumeric(_k);_nk=_nk.trim();__b47.append("Dim s" + _nk + " As String = r.GetDefault(\"" + _k + "\", \"\")").append("\n");__b45.append("item.put(\"" + _nk + "\", s" + _nk + ")").append("\n");__b46.append("s" + _nk + " = SDUIShared.CStr(s" + _nk + ")").append("\n");__b46.append("s" + _nk + " = s" + _nk + ".Trim").append("\n");}__b47.append(__b46.toString());__b47.append(__b45.toString());__b47.append("Next").append("\n");return __b47.toString();};_B.readfile=function(__3d) {var _BANp = gBANp(arguments);var _opt,__b42,__b34,__b43,__b44;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__15d=_B._xlsx["read"](__3d,_opt);_B.__160=_B.__15d["SheetNames"];__b42=_B.__160[0];_B.__161=_B.__15d["Sheets"];__b34=_B.__161[__b42];__b43={};__b43["defval"]="";__b43["dateNF"]="yyyy-mm-dd hh:mm:ss";__b44=_B._xlsx["utils"]["sheet_to_row_object_array"](__b34,__b43);return __b44;};_B.readfileworksheet=function(__3d,_ws) {var _xlsx,_opt,__b42,__b34,__b43,__b44;_xlsx=null;_xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__15d=_xlsx["read"](__3d,_opt);_B.__160=_B.__15d["SheetNames"];__b42=_B.__160[_ws];_B.__161=_B.__15d["Sheets"];__b34=_B.__161[__b42];__b43={};__b43["defval"]="";__b43["dateNF"]="yyyy-mm-dd hh:mm:ss";__b44=_xlsx["utils"]["sheet_to_row_object_array"](__b34,__b43);return __b44;};_B.createstyle=function() {var _s;_s= new banano_sithasodaisyexcel_oxmlstyle();_s.initialize();_s._bold=false;_s.__16b=false;_s.__16c=false;_s.__16d=false;_s.__16e=false;_s.__16f="";_s.__170="";_s.__171="";_s.__172="";_s.__173="";_s.__174="";_s.__176="";_s.__177="";_s.__178="";_s.__179="";_s.__17a="";return _s;};_B.setstyleborder=function(_rc,__174,__175) {var __b4a,_obj;__b4a={};__b4a["color"]=__174;__b4a["style"]=__175;_obj={};_obj["border"]=__b4a;_rc["style"](_obj);return _B;};_B.setstylenumberformat=function(_rc,_nf) {var _obj;_obj={};_obj["numberFormat"]=_nf;_rc["style"](_obj);return _B;};_B.setstylebold=function(_rc,_b) {var _obj;_obj={};_obj["bold"]=_b;_rc["style"](_obj);return _B;};_B.setstyleitalic=function(_rc,_b) {var _obj;_obj={};_obj["italic"]=_b;_rc["style"](_obj);return _B;};_B.setstyleunderline=function(_rc,_b) {var _obj;_obj={};_obj["underline"]=_b;_rc["style"](_obj);return _B;};_B.setstylefontsize=function(_rc,_fs) {var _obj;_obj={};_obj["fontSize"]=_fs;_rc["style"](_obj);return _B;};_B.setstylevalignment=function(_rc,_va) {var _obj;_obj={};_obj["vAlignment"]=_va;_rc["style"](_obj);return _B;};_B.setstylehalignment=function(_rc,_ha) {var _obj;_obj={};_obj["hAlignment"]=_ha;_rc["style"](_obj);return _B;};_B.setstyle=function(_rc,__166) {var _obj,__b4a,_fill;_obj={};if (__166._bold) {_obj["bold"]=__166._bold;}if (__166.__16b) {_obj["italic"]=__166.__16b;}if (__166.__16c) {_obj["underline"]=__166.__16c;}if (__166.__16d) {_obj["strike"]=__166.__16d;}if (__166.__16e) {_obj["fontSize"]=__166.__16e;}if (__166.__16f!="") {_obj["fontColor"]=__166.__16f;}if (__166.__170!="") {_obj["fontName"]=__166.__170;}if (__166.__171!="") {_obj["fontFamily"]=__166.__171;}if (__166.__172!="") {_obj["scheme"]=__166.__172;}if (__166.__173!="") {_obj["numberFormat"]=__166.__173;}if (__166.__177!="") {_obj["vAlignment"]=__166.__177;}if (__166.__176!="") {_obj["hAlignment"]=__166.__176;}if (__166.__174!="" || __166.__175!="") {__b4a={};__b4a["color"]=__166.__174;__b4a["style"]=__166.__175;_obj["border"]=__b4a;}if (__166.__178!="" && __166.__179!="" && __166.__17a!="") {_fill={};_fill["pattern"]=__166.__178;_fill["foreColor"]=__166.__179;_fill["backColor"]=__166.__17a;_obj["fill"]=_fill;}_rc["style"](_obj);};_B.merge=function(__b34,__705) {__b34["merge"](__705);return _B;};_B.getrow=function(__b34,__b35,__b4f) {var _row;_row=__b34["row"](__b35,__b4f);return _row;};_B.getcolumn=function(__b34,__b35,__b4f) {var _colx;_colx=__b34["column"](__b35,__b4f);return _colx;};_B.getcell=function(__b34,__b35,__b4f) {var _colx;_colx=__b34["cell"](__b35,__b4f);return _colx;};_B.createrow=function(__b35,__b4f) {var _row;_row= new banano_sithasodaisyexcel_oxmlrow();_row.initialize();_row.__168=__b4f;_row.__167=__b35;_row.__169.length=0;_row.__166={};return _row;};_B.createformula=function(__165) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__163="formula";_cell.__165=__165;_cell.__166={};return _cell;};_B.createtext=function(__164) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__163="string";_cell.__164=__164;_cell.__166={};return _cell;};_B.createnumber=function(__164) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__163="numeric";_cell.__164=__164;_cell.__166={};return _cell;};_B.createsharedtext=function(__164) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell.__163="sharedString";_cell.__164=__164;_cell.__166={};return _cell;};_B.cell2map=function(_cell) {var _m;_m={};_m["type"]=_cell.__163;_m["value"]=_cell.__164;if (_cell.__165!="") {_m["formula"]=_cell.__165;}return _m;};_B.worksheet=function(__b53) {var __b54;__b54=null;__b54=_B.__15d["sheet"](__b53);return __b54;};_B.addworksheet=function(__b53) {var _bo;_bo=_B.worksheet(__b53,_B);return _bo;};_B.setrow=function(__b34,__b35,__b4f,__169) {__b34["row"](__b35,__b4f,__169);};_B.setcolumn=function(__b34,__b35,__b4f,__169) {__b34["column"](__b35,__b4f,__169);};_B.setrowbo=function(_row,__169) {_row["set"](__169);};_B.setcolbo=function(_col,__169) {_col["set"](__169);};_B.setrow1=function(__b34,_row) {var __b35,__b4f,__169;__b35=_row.__167;__b4f=_row.__168;__169=_row.__169;_B.setrow(__b34,__b35,__b4f,__169,_B);};_B.download=async function(__a6e,__2ac) {var _res,_err,_prom,_args;_res={};_err={};_prom=_B.__15d["download"](_B.__162);await _prom;_prom.then(function(_res) {_args=[];_prom=BANanoPromise();__a6e[(__2ac).toLowerCase()](_args,_prom,_B);}).catch(function(_err) {});};_B.addrowtext=function(_row,__164) {var _cell;_cell=_B.cell2map(_B.createtext(__164,_B),_B);_row.__169.push(_cell);return _B;};_B.addrownumber=function(_row,__164) {var _cell;_cell=_B.cell2map(_B.createnumber(__164,_B),_B);_row.__169.push(_cell);return _B;};_B.addrowsharedtext=function(_row,__164) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__164,_B),_B);_row.__169.push(_cell);return _B;};_B.addrowformula=function(_row,__165) {var _cell;_cell=_B.cell2map(_B.createformula(__165,_B),_B);_row.__169.push(_cell);return _B;};_B.addrowformula1=function(_row,__165,__164) {var _cell,__b57;_cell=_B.createformula(__165,_B);_cell.__164=__164;__b57=_B.cell2map(_cell,_B);_row.__169.push(__b57);return _B;};_B.settext=function(__b34,__b35,__b4f,__164) {var _cell;_cell=_B.cell2map(_B.createtext(__164,_B),_B);__b34["cell"](__b35,__b4f)["set"](_cell);};_B.setcelltext=function(__b58,__164) {var _cell;_cell=_B.cell2map(_B.createtext(__164,_B),_B);__b58["set"](_cell);};_B.setcellnumber=function(__b58,__164) {var _cell;_cell=_B.cell2map(_B.createnumber(__164,_B),_B);__b58["set"](_cell);};_B.setnumber=function(__b34,__b35,__b4f,__164) {var _cell;_cell=_B.cell2map(_B.createnumber(__164,_B),_B);__b34["cell"](__b35,__b4f)["set"](_cell);};_B.setcellsharedtext=function(__b58,__164) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__164,_B),_B);__b58["set"](_cell);};_B.setsharedtext=function(__b34,__b35,__b4f,__164) {var _cell;_cell=_B.cell2map(_B.createsharedtext(__164,_B),_B);__b34["cell"](__b35,__b4f)["set"](_cell);};_B.setcellformula=function(__b58,__165) {var _cell;_cell=_B.cell2map(_B.createformula(__165,_B),_B);__b58["set"](_cell);};_B.setformula=function(__b34,__b35,__b4f,__165) {var _cell;_cell=_B.cell2map(_B.createformula(__165,_B),_B);__b34["cell"](__b35,__b4f)["set"](_cell);};_B.setcellformula1=function(__b58,__165,__164) {var _cell,__b57;_cell=_B.createformula(__165,_B);_cell.__164=__164;__b57=_B.cell2map(_cell,_B);__b58["set"](__b57);};_B.setformula1=function(__b34,__b35,__b4f,__165,__164) {var _cell,__b57;_cell=_B.createformula(__165,_B);_cell.__164=__164;__b57=_B.cell2map(_cell,_B);__b34["cell"](__b35,__b4f)["set"](__b57);};_B.exporttable=function(__b59,__b4a,__6d9,__b5a,__387) {var _ws,__b5b,_rec,__b5c,_rowstart,__b5f,_rptr;_ws=_B.addworksheet("Sheet1",_B);_B.settext(_ws,1,1,__b59,_B);_B.setrow(_ws,2,1,__b5a,_B);__b5b=3;for (var _recindex=0;_recindex<__387.length;_recindex++) {_rec=__387[_recindex];__b5c=_banano_sithasodaisy_sduishared.getlistfrommapkeys(_rec,__6d9);_B.setrow(_ws,__b5b,1,__b5c,_B);__b5b=__b5b+1;}if (__b4a) {__b5e=0;__b5f=_B.createstyle(_B);__b5f.__174=_B.__19c;__b5f.__175=_B.__17d;for (_rowstart=2;_rowstart<=__b5b;_rowstart++) {__b5f._bold=false;_rptr=_B.getrow(_ws,_rowstart,1,_B);if (_rowstart==2) {__b5f._bold=true;}_B.setstyle(_rptr,__b5f,_B);}}_B.download(_B.__14d,"" + _B.__1b4 + "_exceldownload",_B);};}