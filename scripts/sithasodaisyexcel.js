
/* sithasodaisyexcel */
function banano_sithasodaisyexcel_sduiexcel() {var _B=this;_B._workbook=null;_B._oxml=null;_B._xlsx=null;_B._sheetnames=[];_B._sheets=[];_B._fname="";_B._borderthick="thick";_B._bordernone="none";_B._borderthin="thin";_B._bordermedium="medium";_B._borderdashed="dashed";_B._borderdotted="dotted";_B._borderdouble="double";_B._borderhair="hair";_B._bordermediumdashed="mediumDashed";_B._borderdashdot="dashDot";_B._bordermediumdashdot="mediumDashDot";_B._borderdashdotdot="dashDotDot";_B._bordermediumdashdotdot="mediumDashDotDot";_B._borderslantdashdot="slantDashDot";_B._colors_red="F44336";_B._colors_pink="E91E63";_B._colors_purple="9C27B0";_B._colors_deeppurple="673AB7";_B._colors_indigo="3F51B5";_B._colors_blue="2196F3";_B._colors_lightblue="03A9F4";_B._colors_cyan="00BCD4";_B._colors_teal="009688";_B._colors_green="4CAF50";_B._colors_lightgreen="8BC34A";_B._colors_lime="CDDC39";_B._colors_yellow="ffe821";_B._colors_amber="FFC107";_B._colors_orange="FF9800";_B._colors_deeporange="FF5722";_B._colors_brown="795548";_B._colors_grey="9E9E9E";_B._colors_bluegrey="607D8B";_B._colors_black="000000";_B._colors_white="ffffff";_B._colors_transparent="transparent";_B._pattern_darkdown="darkDown";_B._pattern_darkgray="darkGray";_B._pattern_darkgrid="darkGrid";_B._pattern_darkhorizontal="darkHorizontal";_B._pattern_darktrellis="darkTrellis";_B._pattern_darkup="darkUp";_B._pattern_darkvertical="darkVertical";_B._pattern_gray0625="gray0625";_B._pattern_gray125="gray125";_B._pattern_lightdown="lightDown";_B._pattern_lightgray="lightGray";_B._pattern_lightgrid="lightGrid";_B._pattern_lighthorizontal="lightHorizontal";_B._pattern_lighttrellis="lightTrellis";_B._pattern_lightup="lightUp";_B._pattern_lightvertical="lightVertical";_B._pattern_mediumgray="mediumGray";_B._pattern_none="none";_B._pattern_solid="solid";_B._columns={};_B._rows=[];_B._mback={};_B._mevent="";_B.initialize=function(_module,_event,_filename) {_B._mback=_module;_B._mevent=_event;;;;_B._oxml=oxml;_B._workbook=_B._oxml["xlsx"]();_B._fname=_filename;_B._columns={};_B._rows.length=0;};_B.addcolumn=function(_colname,_colheading) {_B._columns[_colname]=_colheading;};_B.addcolumns=function(_ws,_m) {var _k,_v;var _kKeys = Object.keys(_m);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_m[_k];_B.addcolumn(_k,_v,_B);}_B.setcolumns(_ws,1,_B);};_B.clearcolumns=function() {_B._columns={};};_B.clearrows=function() {_B._rows.length=0;};_B.setheaderfields=function(_flds) {var _fldtot,_fldcnt,_fldname;_fldtot=_flds.length-1;_fldcnt=0;for (_fldcnt=0;_fldcnt<=_fldtot;_fldcnt++) {_fldname=_flds[_fldcnt];_B.addcolumn(_fldname,_fldname,_B);}};_B.setheadertitles=function(_flds) {var _fldtot,_fldcnt,_fldname;_fldtot=_flds.length-1;_fldcnt=0;for (_fldcnt=0;_fldcnt<=_fldtot;_fldcnt++) {_fldname=_flds[_fldcnt];_B.addcolumn(_fldname,_fldname,_B);}};_B.setcolumns=function(_sheet,_rowpos) {var _hdrlist,_colcnt,_coltot,_hdrname;_hdrlist=[];_hdrlist.length=0;_colcnt=0;_coltot=Object.keys(_B._columns).length-1;for (_colcnt=0;_colcnt<=_coltot;_colcnt++) {_hdrname=banano_getB4JValueAt(_B._columns,_colcnt);_hdrlist.push(_hdrname);}_B.setrow(_sheet,_rowpos,1,_hdrlist,_B);};_B.setrowsfromdatatable=function(_recs) {var _reccnt,_rectot,_xlrec,_xlrpt,_hdrn,_v;_reccnt=0;_rectot=_recs.length-1;for (_reccnt=0;_reccnt<=_rectot;_reccnt++) {_xlrec=_recs[_reccnt];_xlrpt=[];_xlrpt.length=0;var _hdrnKeys = Object.keys(_B._columns);for (var _hdrnindex=0;_hdrnindex<_hdrnKeys.length;_hdrnindex++) {_hdrn=_hdrnKeys[_hdrnindex];_hdrn=_hdrn.toLowerCase();_v=_xlrec[_hdrn];_v=_B.cstr(_v,_B);_v=_v.trim();_xlrpt.push(_v);}_B._rows.push(_xlrpt);}};_B.setcolumnsfromdatatable=function(_xcolumns) {var _xcols,_coltot,_colcnt,_hdr,_sdatakey,_stitle;_xcols=[];_xcols.length=0;_coltot=Object.keys(_xcolumns).length-1;_colcnt=0;for (_colcnt=0;_colcnt<=_coltot;_colcnt++) {_hdr=banano_getB4JValueAt(_xcolumns,_colcnt);_sdatakey=_hdr._name;_stitle=_hdr._title;switch ("" + _hdr._typeof) {case "" + "action":case "" + "edit":case "" + "delete":case "" + "print":case "" + "delete":case "" + "clone":case "" + "save":case "" + "cancel":case "" + "button":case "" + "menu":break;default:_B._columns[_sdatakey]=_stitle;break;}}};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.readfromarraybuffer=function(_data) {var _opt;;_B._columns={};_B._rows.length=0;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B._workbook=_B._xlsx["read"](_data,_opt);_B._sheetnames=_B._workbook["SheetNames"];_B._sheets=_B._workbook["Sheets"];};_B.readsheetcontentsbypos=function(_pos) {var _firstsheet,_sheet,_readopt,_excelrows;_firstsheet=_B._sheetnames[_pos];_sheet=_B._sheets[_firstsheet];_readopt={};_readopt["defval"]="";_readopt["dateNF"]="yyyy-mm-dd hh:mm:ss";_excelrows=_B._xlsx["utils"]["sheet_to_row_object_array"](_sheet,_readopt);return _excelrows;};_B.getsinglecode=function(_lst) {var _sbline1,_sbtrim,_sbline,_r1,_k,_nk;_sbline1=new StringBuilder();_sbline1.init();_sbline1.isinitialized=true;_sbtrim=new StringBuilder();_sbtrim.init();_sbtrim.isinitialized=true;_sbline1.append("'create a new record").append("\n");_sbline1.append("Dim item As Map").append("\n");_sbline1.append("item.Initialize").append("\n");_sbline=new StringBuilder();_sbline.init();_sbline.isinitialized=true;_sbline.append("For Each r As Map In records").append("\n");_r1=_lst[0];var _kKeys = Object.keys(_r1);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nk=_banano_sithasodaisy_sduishared.alphanumeric(_k);_nk=_nk.trim();_sbline.append("Dim s" + _nk + " As String = r.GetDefault(\"" + _k + "\", \"\")").append("\n");_sbline1.append("item.put(\"" + _nk + "\", s" + _nk + ")").append("\n");_sbtrim.append("s" + _nk + " = SDUIShared.CStr(s" + _nk + ")").append("\n");_sbtrim.append("s" + _nk + " = s" + _nk + ".Trim").append("\n");}_sbline.append(_sbtrim.toString());_sbline.append(_sbline1.toString());_sbline.append("Next").append("\n");return _sbline.toString();};_B.readfile=function(_data) {var _BANp = gBANp(arguments);var _opt,_firstsheet,_sheet,_readopt,_excelrows;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B._workbook=_B._xlsx["read"](_data,_opt);_B._sheetnames=_B._workbook["SheetNames"];_firstsheet=_B._sheetnames[0];_B._sheets=_B._workbook["Sheets"];_sheet=_B._sheets[_firstsheet];_readopt={};_readopt["defval"]="";_readopt["dateNF"]="yyyy-mm-dd hh:mm:ss";_excelrows=_B._xlsx["utils"]["sheet_to_row_object_array"](_sheet,_readopt);return _excelrows;};_B.readfileworksheet=function(_data,_ws) {var _xlsx,_opt,_firstsheet,_sheet,_readopt,_excelrows;_xlsx=null;_xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B._workbook=_xlsx["read"](_data,_opt);_B._sheetnames=_B._workbook["SheetNames"];_firstsheet=_B._sheetnames[_ws];_B._sheets=_B._workbook["Sheets"];_sheet=_B._sheets[_firstsheet];_readopt={};_readopt["defval"]="";_readopt["dateNF"]="yyyy-mm-dd hh:mm:ss";_excelrows=_xlsx["utils"]["sheet_to_row_object_array"](_sheet,_readopt);return _excelrows;};_B.createstyle=function() {var _s;_s= new banano_sithasodaisyexcel_oxmlstyle();_s.initialize();_s._bold=false;_s._italic=false;_s._underline=false;_s._strike=false;_s._fontsize=false;_s._fontcolor="";_s._fontname="";_s._fontfamily="";_s._scheme="";_s._numberfrmat="";_s._bordercolor="";_s._halignment="";_s._valignment="";_s._fillpattern="";_s._fillforecolor="";_s._fillbackground="";return _s;};_B.setstyleborder=function(_rc,_bordercolor,_borderthickness) {var _border,_obj;_border={};_border["color"]=_bordercolor;_border["style"]=_borderthickness;_obj={};_obj["border"]=_border;_rc["style"](_obj);return _B;};_B.setstylenumberformat=function(_rc,_nf) {var _obj;_obj={};_obj["numberFormat"]=_nf;_rc["style"](_obj);return _B;};_B.setstylebold=function(_rc,_b) {var _obj;_obj={};_obj["bold"]=_b;_rc["style"](_obj);return _B;};_B.setstyleitalic=function(_rc,_b) {var _obj;_obj={};_obj["italic"]=_b;_rc["style"](_obj);return _B;};_B.setstyleunderline=function(_rc,_b) {var _obj;_obj={};_obj["underline"]=_b;_rc["style"](_obj);return _B;};_B.setstylefontsize=function(_rc,_fs) {var _obj;_obj={};_obj["fontSize"]=_fs;_rc["style"](_obj);return _B;};_B.setstylevalignment=function(_rc,_va) {var _obj;_obj={};_obj["vAlignment"]=_va;_rc["style"](_obj);return _B;};_B.setstylehalignment=function(_rc,_ha) {var _obj;_obj={};_obj["hAlignment"]=_ha;_rc["style"](_obj);return _B;};_B.setstyle=function(_rc,_style) {var _obj,_border,_fill;_obj={};if (_style._bold) {_obj["bold"]=_style._bold;}if (_style._italic) {_obj["italic"]=_style._italic;}if (_style._underline) {_obj["underline"]=_style._underline;}if (_style._strike) {_obj["strike"]=_style._strike;}if (_style._fontsize) {_obj["fontSize"]=_style._fontsize;}if (_style._fontcolor!="") {_obj["fontColor"]=_style._fontcolor;}if (_style._fontname!="") {_obj["fontName"]=_style._fontname;}if (_style._fontfamily!="") {_obj["fontFamily"]=_style._fontfamily;}if (_style._scheme!="") {_obj["scheme"]=_style._scheme;}if (_style._numberfrmat!="") {_obj["numberFormat"]=_style._numberfrmat;}if (_style._valignment!="") {_obj["vAlignment"]=_style._valignment;}if (_style._halignment!="") {_obj["hAlignment"]=_style._halignment;}if (_style._bordercolor!="" || _style._borderthickness!="") {_border={};_border["color"]=_style._bordercolor;_border["style"]=_style._borderthickness;_obj["border"]=_border;}if (_style._fillpattern!="" && _style._fillforecolor!="" && _style._fillbackground!="") {_fill={};_fill["pattern"]=_style._fillpattern;_fill["foreColor"]=_style._fillforecolor;_fill["backColor"]=_style._fillbackground;_obj["fill"]=_fill;}_rc["style"](_obj);};_B.merge=function(_sheet,_range) {_sheet["merge"](_range);return _B;};_B.getrow=function(_sheet,_rowpos,_colpos) {var _row;_row=_sheet["row"](_rowpos,_colpos);return _row;};_B.getcolumn=function(_sheet,_rowpos,_colpos) {var _colx;_colx=_sheet["column"](_rowpos,_colpos);return _colx;};_B.getcell=function(_sheet,_rowpos,_colpos) {var _colx;_colx=_sheet["cell"](_rowpos,_colpos);return _colx;};_B.createrow=function(_rowpos,_colpos) {var _row;_row= new banano_sithasodaisyexcel_oxmlrow();_row.initialize();_row._columnindex=_colpos;_row._rowindex=_rowpos;_row._values.length=0;_row._style={};return _row;};_B.createformula=function(_formula) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell._typeof="formula";_cell._formula=_formula;_cell._style={};return _cell;};_B.createtext=function(_value) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell._typeof="string";_cell._value=_value;_cell._style={};return _cell;};_B.createnumber=function(_value) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell._typeof="numeric";_cell._value=_value;_cell._style={};return _cell;};_B.createsharedtext=function(_value) {var _cell;_cell= new banano_sithasodaisyexcel_oxmlcell();_cell.initialize();_cell._typeof="sharedString";_cell._value=_value;_cell._style={};return _cell;};_B.cell2map=function(_cell) {var _m;_m={};_m["type"]=_cell._typeof;_m["value"]=_cell._value;if (_cell._formula!="") {_m["formula"]=_cell._formula;}return _m;};_B.worksheet=function(_sheetname) {var _wksheet;_wksheet=null;_wksheet=_B._workbook["sheet"](_sheetname);return _wksheet;};_B.addworksheet=function(_sheetname) {var _bo;_bo=_B.worksheet(_sheetname,_B);return _bo;};_B.setrow=function(_sheet,_rowpos,_colpos,_values) {_sheet["row"](_rowpos,_colpos,_values);};_B.setcolumn=function(_sheet,_rowpos,_colpos,_values) {_sheet["column"](_rowpos,_colpos,_values);};_B.setrowbo=function(_row,_values) {_row["set"](_values);};_B.setcolbo=function(_col,_values) {_col["set"](_values);};_B.setrow1=function(_sheet,_row) {var _rowpos,_colpos,_values;_rowpos=_row._rowindex;_colpos=_row._columnindex;_values=_row._values;_B.setrow(_sheet,_rowpos,_colpos,_values,_B);};_B.download=async function(_module,_methodname) {var _res,_err,_prom,_args;_res={};_err={};_prom=_B._workbook["download"](_B._fname);await _prom;_prom.then(function(_res) {_args=[];_prom=BANanoPromise();_module[(_methodname).toLowerCase()](_args,_prom,_B);}).catch(function(_err) {});};_B.addrowtext=function(_row,_value) {var _cell;_cell=_B.cell2map(_B.createtext(_value,_B),_B);_row._values.push(_cell);return _B;};_B.addrownumber=function(_row,_value) {var _cell;_cell=_B.cell2map(_B.createnumber(_value,_B),_B);_row._values.push(_cell);return _B;};_B.addrowsharedtext=function(_row,_value) {var _cell;_cell=_B.cell2map(_B.createsharedtext(_value,_B),_B);_row._values.push(_cell);return _B;};_B.addrowformula=function(_row,_formula) {var _cell;_cell=_B.cell2map(_B.createformula(_formula,_B),_B);_row._values.push(_cell);return _B;};_B.addrowformula1=function(_row,_formula,_value) {var _cell,_cellv;_cell=_B.createformula(_formula,_B);_cell._value=_value;_cellv=_B.cell2map(_cell,_B);_row._values.push(_cellv);return _B;};_B.settext=function(_sheet,_rowpos,_colpos,_value) {var _cell;_cell=_B.cell2map(_B.createtext(_value,_B),_B);_sheet["cell"](_rowpos,_colpos)["set"](_cell);};_B.setcelltext=function(_cellbo,_value) {var _cell;_cell=_B.cell2map(_B.createtext(_value,_B),_B);_cellbo["set"](_cell);};_B.setcellnumber=function(_cellbo,_value) {var _cell;_cell=_B.cell2map(_B.createnumber(_value,_B),_B);_cellbo["set"](_cell);};_B.setnumber=function(_sheet,_rowpos,_colpos,_value) {var _cell;_cell=_B.cell2map(_B.createnumber(_value,_B),_B);_sheet["cell"](_rowpos,_colpos)["set"](_cell);};_B.setcellsharedtext=function(_cellbo,_value) {var _cell;_cell=_B.cell2map(_B.createsharedtext(_value,_B),_B);_cellbo["set"](_cell);};_B.setsharedtext=function(_sheet,_rowpos,_colpos,_value) {var _cell;_cell=_B.cell2map(_B.createsharedtext(_value,_B),_B);_sheet["cell"](_rowpos,_colpos)["set"](_cell);};_B.setcellformula=function(_cellbo,_formula) {var _cell;_cell=_B.cell2map(_B.createformula(_formula,_B),_B);_cellbo["set"](_cell);};_B.setformula=function(_sheet,_rowpos,_colpos,_formula) {var _cell;_cell=_B.cell2map(_B.createformula(_formula,_B),_B);_sheet["cell"](_rowpos,_colpos)["set"](_cell);};_B.setcellformula1=function(_cellbo,_formula,_value) {var _cell,_cellv;_cell=_B.createformula(_formula,_B);_cell._value=_value;_cellv=_B.cell2map(_cell,_B);_cellbo["set"](_cellv);};_B.setformula1=function(_sheet,_rowpos,_colpos,_formula,_value) {var _cell,_cellv;_cell=_B.createformula(_formula,_B);_cell._value=_value;_cellv=_B.cell2map(_cell,_B);_sheet["cell"](_rowpos,_colpos)["set"](_cellv);};_B.exporttable=function(_mexceltitle,_border,_fieldnames,_fieldtitles,_content) {var _ws,_rowcnt,_rec,_rowvalues,_rowstart,_rstyle,_rptr;_ws=_B.addworksheet("Sheet1",_B);_B.settext(_ws,1,1,_mexceltitle,_B);_B.setrow(_ws,2,1,_fieldtitles,_B);_rowcnt=3;for (var _recindex=0;_recindex<_content.length;_recindex++) {_rec=_content[_recindex];_rowvalues=_banano_sithasodaisy_sduishared.getlistfrommapkeys(_rec,_fieldnames);_B.setrow(_ws,_rowcnt,1,_rowvalues,_B);_rowcnt=_rowcnt+1;}if (_border) {_rowstart=0;_rstyle=_B.createstyle(_B);_rstyle._bordercolor=_B._colors_black;_rstyle._borderthickness=_B._borderthin;for (_rowstart=2;_rowstart<=_rowcnt;_rowstart++) {_rstyle._bold=false;_rptr=_B.getrow(_ws,_rowstart,1,_B);if (_rowstart==2) {_rstyle._bold=true;}_B.setstyle(_rptr,_rstyle,_B);}}_B.download(_B._mback,"" + _B._mevent + "_exceldownload",_B);};}