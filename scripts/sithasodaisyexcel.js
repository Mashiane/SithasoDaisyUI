
/* sithasodaisyexcel */
function banano_sithasodaisyexcel_sduiexcel() {var _B=this;_B.__16d=null;_B._oxml=null;_B._xlsx=null;_B.__170=[];_B.__171=[];_B.__172="";_B.__18b="thick";_B.__18c="none";_B.__18d="thin";_B.__18e="medium";_B.__18f="dashed";_B.__190="dotted";_B.__191="double";_B.__192="hair";_B.__193="mediumDashed";_B.__194="dashDot";_B.__195="mediumDashDot";_B.__196="dashDotDot";_B.__197="mediumDashDotDot";_B.__198="slantDashDot";_B.__199="F44336";_B.__19a="E91E63";_B.__19b="9C27B0";_B.__19c="673AB7";_B.__19d="3F51B5";_B.__19e="2196F3";_B.__19f="03A9F4";_B.__1a0="00BCD4";_B.__1a1="009688";_B.__1a2="4CAF50";_B.__1a3="8BC34A";_B.__1a4="CDDC39";_B.__1a5="ffe821";_B.__1a6="FFC107";_B.__1a7="FF9800";_B.__1a8="FF5722";_B.__1a9="795548";_B.__1aa="9E9E9E";_B.__1ab="607D8B";_B.__1ac="000000";_B.__1ad="ffffff";_B.__1ae="transparent";_B.__1af="darkDown";_B.__1b0="darkGray";_B.__1b1="darkGrid";_B.__1b2="darkHorizontal";_B.__1b3="darkTrellis";_B.__1b4="darkUp";_B.__1b5="darkVertical";_B.__1b6="gray0625";_B.__1b7="gray125";_B.__1b8="lightDown";_B.__1b9="lightGray";_B.__1ba="lightGrid";_B.__1bb="lightHorizontal";_B.__1bc="lightTrellis";_B.__1bd="lightUp";_B.__1be="lightVertical";_B.__1bf="mediumGray";_B.__1c0="none";_B.__1c1="solid";_B.__1c2={};_B._rows=[];_B.__15d={};_B.__1c4="";_B.initialize=function(__c79,__d15,_filename) {_B.__15d=__c79;_B.__1c4=__d15;;;;_B._oxml=oxml;_B.__16d=_B._oxml["xlsx"]();_B.__172=_filename;_B.__1c2={};_B._rows.length=0;};_B.addcolumn=function(__cfb,__d42) {_B.__1c2[__cfb]=__d42;};_B.addcolumns=function(_ws,_m) {var _k,_v;var _kKeys = Object.keys(_m);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_v=_m[_k];_B.addcolumn(_k,_v,_B);}_B.setcolumns(_ws,1,_B);};_B.clearcolumns=function() {_B.__1c2={};};_B.clearrows=function() {_B._rows.length=0;};_B.setheaderfields=function(_flds) {var __d44,_fldcnt,__cac;__d44=_flds.length-1;__d45=0;for (_fldcnt=0;_fldcnt<=__d44;_fldcnt++) {__cac=_flds[_fldcnt];_B.addcolumn(__cac,__cac,_B);}};_B.setheadertitles=function(_flds) {var __d44,_fldcnt,__cac;__d44=_flds.length-1;__d45=0;for (_fldcnt=0;_fldcnt<=__d44;_fldcnt++) {__cac=_flds[_fldcnt];_B.addcolumn(__cac,__cac,_B);}};_B.setcolumns=function(__d46,__d47) {var __d48,_colcnt,__d4a,__d4b;__d48=[];__d48.length=0;__d49=0;__d4a=Object.keys(_B.__1c2).length-1;for (_colcnt=0;_colcnt<=__d4a;_colcnt++) {__d4b=banano_getB4JValueAt(_B.__1c2,_colcnt);__d48.push(__d4b);}_B.setrow(__d46,__d47,1,__d48,_B);};_B.setrowsfromdatatable=function(_recs) {var _reccnt,__d4d,__d4e,__d4f,_hdrn,_v;__d4c=0;__d4d=_recs.length-1;for (_reccnt=0;_reccnt<=__d4d;_reccnt++) {__d4e=_recs[_reccnt];__d4f=[];__d4f.length=0;var _hdrnKeys = Object.keys(_B.__1c2);for (var _hdrnindex=0;_hdrnindex<_hdrnKeys.length;_hdrnindex++) {_hdrn=_hdrnKeys[_hdrnindex];_hdrn=_hdrn.toLowerCase();_v=__d4e[_hdrn];_v=_B.cstr(_v,_B);_v=_v.trim();__d4f.push(_v);}_B._rows.push(__d4f);}};_B.setcolumnsfromdatatable=function(__d50) {var __d51,__d4a,_colcnt,_hdr,__d53,__284;__d51=[];__d51.length=0;__d4a=Object.keys(__d50).length-1;__d49=0;for (_colcnt=0;_colcnt<=__d4a;_colcnt++) {_hdr=banano_getB4JValueAt(__d50,_colcnt);__d53=_hdr._name;__284=_hdr._title;switch ("" + _hdr._typeof) {case "" + "action":case "" + "edit":case "" + "delete":case "" + "print":case "" + "delete":case "" + "clone":case "" + "save":case "" + "cancel":case "" + "button":case "" + "menu":break;default:_B.__1c2[__d53]=__284;break;}}};_B.cstr=function(_o) {if (is.null(_o) || is.undefined(_o)) {_o="";}if (_o=="null") { return "";}if (_o=="undefined") { return "";}return ""+_o;};_B.readfromarraybuffer=function(__3d) {var _opt;;_B.__1c2={};_B._rows.length=0;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__16d=_B._xlsx["read"](__3d,_opt);_B.__170=_B.__16d["SheetNames"];_B.__171=_B.__16d["Sheets"];};_B.readsheetcontentsbypos=function(_pos) {var __d54,__d46,__d55,__d56;__d54=_B.__170[_pos];__d46=_B.__171[__d54];__d55={};__d55["defval"]="";__d55["dateNF"]="yyyy-mm-dd hh:mm:ss";__d56=_B._xlsx["utils"]["sheet_to_row_object_array"](__d46,__d55);return __d56;};_B.getsinglecode=function(_lst) {var __d57,__d58,__d59,_r1,_k,_nk;__d57=new StringBuilder();__d57.init();__d57.isinitialized=true;__d58=new StringBuilder();__d58.init();__d58.isinitialized=true;__d57.append("'create a new record").append("\n");__d57.append("Dim item As Map").append("\n");__d57.append("item.Initialize").append("\n");__d59=new StringBuilder();__d59.init();__d59.isinitialized=true;__d59.append("For Each r As Map In records").append("\n");_r1=_lst[0];var _kKeys = Object.keys(_r1);for (var _kindex=0;_kindex<_kKeys.length;_kindex++) {_k=_kKeys[_kindex];_nk=_banano_sithasodaisy_sduishared.alphanumeric(_k);_nk=_nk.trim();__d59.append("Dim s" + _nk + " As String = r.GetDefault(\"" + _k + "\", \"\")").append("\n");__d57.append("item.put(\"" + _nk + "\", s" + _nk + ")").append("\n");__d58.append("s" + _nk + " = SDUIShared.CStr(s" + _nk + ")").append("\n");__d58.append("s" + _nk + " = s" + _nk + ".Trim").append("\n");}__d59.append(__d58.toString());__d59.append(__d57.toString());__d59.append("Next").append("\n");return __d59.toString();};_B.readfile=function(__3d) {var _BANp = gBANp(arguments);var _opt,__d54,__d46,__d55,__d56;_B._xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__16d=_B._xlsx["read"](__3d,_opt);_B.__170=_B.__16d["SheetNames"];__d54=_B.__170[0];_B.__171=_B.__16d["Sheets"];__d46=_B.__171[__d54];__d55={};__d55["defval"]="";__d55["dateNF"]="yyyy-mm-dd hh:mm:ss";__d56=_B._xlsx["utils"]["sheet_to_row_object_array"](__d46,__d55);return __d56;};_B.readfileworksheet=function(__3d,_ws) {var _xlsx,_opt,__d54,__d46,__d55,__d56;_xlsx=null;_xlsx=XLSX;_opt={};_opt["type"]="binary";_opt["cellDates"]=true;_opt["cellText"]=false;_B.__16d=_xlsx["read"](__3d,_opt);_B.__170=_B.__16d["SheetNames"];__d54=_B.__170[_ws];_B.__171=_B.__16d["Sheets"];__d46=_B.__171[__d54];__d55={};__d55["defval"]="";__d55["dateNF"]="yyyy-mm-dd hh:mm:ss";__d56=_xlsx["utils"]["sheet_to_row_object_array"](__d46,__d55);return __d56;};_B.createstyle=function() {var _s;_s=(typeof banano_sithasodaisyexcel_oxmlstyle === 'function') ? new banano_sithasodaisyexcel_oxmlstyle(): null;_s.initialize();_s._bold=false;_s._italic=false;_s._underline=false;_s._strike=false;_s._fontsize=false;_s._fontcolor="";_s._fontname="";_s._fontfamily="";_s._scheme="";_s._numberfrmat="";_s._bordercolor="";_s._halignment="";_s._valignment="";_s._fillpattern="";_s._fillforecolor="";_s._fillbackground="";return _s;};_B.setstyleborder=function(_rc,_bordercolor,_borderthickness) {var __d5c,_obj;__d5c={};__d5c["color"]=_bordercolor;__d5c["style"]=_borderthickness;_obj={};_obj["border"]=__d5c;_rc["style"](_obj);return _B;};_B.setstylenumberformat=function(_rc,_nf) {var _obj;_obj={};_obj["numberFormat"]=_nf;_rc["style"](_obj);return _B;};_B.setstylebold=function(_rc,_b) {var _obj;_obj={};_obj["bold"]=_b;_rc["style"](_obj);return _B;};_B.setstyleitalic=function(_rc,_b) {var _obj;_obj={};_obj["italic"]=_b;_rc["style"](_obj);return _B;};_B.setstyleunderline=function(_rc,_b) {var _obj;_obj={};_obj["underline"]=_b;_rc["style"](_obj);return _B;};_B.setstylefontsize=function(_rc,_fs) {var _obj;_obj={};_obj["fontSize"]=_fs;_rc["style"](_obj);return _B;};_B.setstylevalignment=function(_rc,_va) {var _obj;_obj={};_obj["vAlignment"]=_va;_rc["style"](_obj);return _B;};_B.setstylehalignment=function(_rc,_ha) {var _obj;_obj={};_obj["hAlignment"]=_ha;_rc["style"](_obj);return _B;};_B.setstyle=function(_rc,_style) {var _obj,__d5c,_fill;_obj={};if (_style._bold) {_obj["bold"]=_style._bold;}if (_style._italic) {_obj["italic"]=_style._italic;}if (_style._underline) {_obj["underline"]=_style._underline;}if (_style._strike) {_obj["strike"]=_style._strike;}if (_style._fontsize) {_obj["fontSize"]=_style._fontsize;}if (_style._fontcolor!="") {_obj["fontColor"]=_style._fontcolor;}if (_style._fontname!="") {_obj["fontName"]=_style._fontname;}if (_style._fontfamily!="") {_obj["fontFamily"]=_style._fontfamily;}if (_style._scheme!="") {_obj["scheme"]=_style._scheme;}if (_style._numberfrmat!="") {_obj["numberFormat"]=_style._numberfrmat;}if (_style._valignment!="") {_obj["vAlignment"]=_style._valignment;}if (_style._halignment!="") {_obj["hAlignment"]=_style._halignment;}if (_style._bordercolor!="" || _style._borderthickness!="") {__d5c={};__d5c["color"]=_style._bordercolor;__d5c["style"]=_style._borderthickness;_obj["border"]=__d5c;}if (_style._fillpattern!="" && _style._fillforecolor!="" && _style._fillbackground!="") {_fill={};_fill["pattern"]=_style._fillpattern;_fill["foreColor"]=_style._fillforecolor;_fill["backColor"]=_style._fillbackground;_obj["fill"]=_fill;}_rc["style"](_obj);};_B.merge=function(__d46,_range) {__d46["merge"](_range);return _B;};_B.getrow=function(__d46,__d47,__d61) {var _row;_row=__d46["row"](__d47,__d61);return _row;};_B.getcolumn=function(__d46,__d47,__d61) {var _colx;_colx=__d46["column"](__d47,__d61);return _colx;};_B.getcell=function(__d46,__d47,__d61) {var _colx;_colx=__d46["cell"](__d47,__d61);return _colx;};_B.createrow=function(__d47,__d61) {var _row;_row=(typeof banano_sithasodaisyexcel_oxmlrow === 'function') ? new banano_sithasodaisyexcel_oxmlrow(): null;_row.initialize();_row._columnindex=__d61;_row._rowindex=__d47;_row._values.length=0;_row._style={};return _row;};_B.createformula=function(_formula) {var _cell;_cell=(typeof banano_sithasodaisyexcel_oxmlcell === 'function') ? new banano_sithasodaisyexcel_oxmlcell(): null;_cell.initialize();_cell._typeof="formula";_cell._formula=_formula;_cell._style={};return _cell;};_B.createtext=function(_value) {var _cell;_cell=(typeof banano_sithasodaisyexcel_oxmlcell === 'function') ? new banano_sithasodaisyexcel_oxmlcell(): null;_cell.initialize();_cell._typeof="string";_cell._value=_value;_cell._style={};return _cell;};_B.createnumber=function(_value) {var _cell;_cell=(typeof banano_sithasodaisyexcel_oxmlcell === 'function') ? new banano_sithasodaisyexcel_oxmlcell(): null;_cell.initialize();_cell._typeof="numeric";_cell._value=_value;_cell._style={};return _cell;};_B.createsharedtext=function(_value) {var _cell;_cell=(typeof banano_sithasodaisyexcel_oxmlcell === 'function') ? new banano_sithasodaisyexcel_oxmlcell(): null;_cell.initialize();_cell._typeof="sharedString";_cell._value=_value;_cell._style={};return _cell;};_B.cell2map=function(_cell) {var _m;_m={};_m["type"]=_cell._typeof;_m["value"]=_cell._value;if (_cell._formula!="") {_m["formula"]=_cell._formula;}return _m;};_B.worksheet=function(__d65) {var __d66;__d66=null;__d66=_B.__16d["sheet"](__d65);return __d66;};_B.addworksheet=function(__d65) {var _bo;_bo=_B.worksheet(__d65,_B);return _bo;};_B.setrow=function(__d46,__d47,__d61,_values) {__d46["row"](__d47,__d61,_values);};_B.setcolumn=function(__d46,__d47,__d61,_values) {__d46["column"](__d47,__d61,_values);};_B.setrowbo=function(_row,_values) {_row["set"](_values);};_B.setcolbo=function(_col,_values) {_col["set"](_values);};_B.setrow1=function(__d46,_row) {var __d47,__d61,_values;__d47=_row._rowindex;__d61=_row._columnindex;_values=_row._values;_B.setrow(__d46,__d47,__d61,_values,_B);};_B.download=async function(__c79,__2c3) {var _res,_err,_prom,_args;_res={};_err={};_prom=_B.__16d["download"](_B.__172);await _prom;_prom.then(function(_res) {_args=[];_prom=BANanoPromise();__c79[(__2c3).toLowerCase()](_args,_prom,_B);}).catch(function(_err) {});};_B.addrowtext=function(_row,_value) {var _cell;_cell=_B.cell2map(_B.createtext(_value,_B),_B);_row._values.push(_cell);return _B;};_B.addrownumber=function(_row,_value) {var _cell;_cell=_B.cell2map(_B.createnumber(_value,_B),_B);_row._values.push(_cell);return _B;};_B.addrowsharedtext=function(_row,_value) {var _cell;_cell=_B.cell2map(_B.createsharedtext(_value,_B),_B);_row._values.push(_cell);return _B;};_B.addrowformula=function(_row,_formula) {var _cell;_cell=_B.cell2map(_B.createformula(_formula,_B),_B);_row._values.push(_cell);return _B;};_B.addrowformula1=function(_row,_formula,_value) {var _cell,__d69;_cell=_B.createformula(_formula,_B);_cell._value=_value;__d69=_B.cell2map(_cell,_B);_row._values.push(__d69);return _B;};_B.settext=function(__d46,__d47,__d61,_value) {var _cell;_cell=_B.cell2map(_B.createtext(_value,_B),_B);__d46["cell"](__d47,__d61)["set"](_cell);};_B.setcelltext=function(__d6a,_value) {var _cell;_cell=_B.cell2map(_B.createtext(_value,_B),_B);__d6a["set"](_cell);};_B.setcellnumber=function(__d6a,_value) {var _cell;_cell=_B.cell2map(_B.createnumber(_value,_B),_B);__d6a["set"](_cell);};_B.setnumber=function(__d46,__d47,__d61,_value) {var _cell;_cell=_B.cell2map(_B.createnumber(_value,_B),_B);__d46["cell"](__d47,__d61)["set"](_cell);};_B.setcellsharedtext=function(__d6a,_value) {var _cell;_cell=_B.cell2map(_B.createsharedtext(_value,_B),_B);__d6a["set"](_cell);};_B.setsharedtext=function(__d46,__d47,__d61,_value) {var _cell;_cell=_B.cell2map(_B.createsharedtext(_value,_B),_B);__d46["cell"](__d47,__d61)["set"](_cell);};_B.setcellformula=function(__d6a,_formula) {var _cell;_cell=_B.cell2map(_B.createformula(_formula,_B),_B);__d6a["set"](_cell);};_B.setformula=function(__d46,__d47,__d61,_formula) {var _cell;_cell=_B.cell2map(_B.createformula(_formula,_B),_B);__d46["cell"](__d47,__d61)["set"](_cell);};_B.setcellformula1=function(__d6a,_formula,_value) {var _cell,__d69;_cell=_B.createformula(_formula,_B);_cell._value=_value;__d69=_B.cell2map(_cell,_B);__d6a["set"](__d69);};_B.setformula1=function(__d46,__d47,__d61,_formula,_value) {var _cell,__d69;_cell=_B.createformula(_formula,_B);_cell._value=_value;__d69=_B.cell2map(_cell,_B);__d46["cell"](__d47,__d61)["set"](__d69);};_B.exporttable=function(__d6b,__d5c,_fieldnames,__d6c,_content) {var _ws,__d6d,_rec,__d6e,_rowstart,__d71,_rptr;_ws=_B.addworksheet("Sheet1",_B);_B.settext(_ws,1,1,__d6b,_B);_B.setrow(_ws,2,1,__d6c,_B);__d6d=3;for (var _recindex=0;_recindex<_content.length;_recindex++) {_rec=_content[_recindex];__d6e=_banano_sithasodaisy_sduishared.getlistfrommapkeys(_rec,_fieldnames);_B.setrow(_ws,__d6d,1,__d6e,_B);__d6d=__d6d+1;}if (__d5c) {__d70=0;__d71=_B.createstyle(_B);__d71._bordercolor=_B.__1ac;__d71._borderthickness=_B.__18d;for (_rowstart=2;_rowstart<=__d6d;_rowstart++) {__d71._bold=false;_rptr=_B.getrow(_ws,_rowstart,1,_B);if (_rowstart==2) {__d71._bold=true;}_B.setstyle(_rptr,__d71,_B);}}_B.download(_B.__15d,"" + _B.__1c4 + "_exceldownload",_B);};}